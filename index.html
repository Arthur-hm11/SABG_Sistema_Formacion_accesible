
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Promoci√≥n de la Formaci√≥n Acad√©mica - SABG</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --guinda: #6B2C40;
            --vino: #8B3A52;
            --beige: #D4C4A8;
            --gold: #E8DCC4;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e293b;
            --gradient1: linear-gradient(135deg, #6B2C40 0%, #8B3A52 100%);
            --gradient2: linear-gradient(135deg, #8B3A52 0%, #A0475E 100%);
            --gradient3: linear-gradient(135deg, #6B2C40 0%, #D4C4A8 100%);
            --gradient4: linear-gradient(135deg, #D4C4A8 0%, #E8DCC4 100%);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #6B2C40 0%, #8B3A52 25%, #A0475E 50%, #D4C4A8 100%);
            background-attachment: fixed;
            min-height: 100vh;
        }

        /* Login Screen */
        #loginScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #6B2C40 0%, #8B3A52 25%, #A0475E 50%, #D4C4A8 100%);
            background-attachment: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            overflow: hidden;
        }

        #loginScreen.hidden {
            display: none;
        }
        
        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--guinda);
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            display: none;
        }

        .autocomplete-suggestions.show {
            display: block;
        }

        .suggestion-item {
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 1px solid #e2e8f0;
        }

        .suggestion-item:last-child {
            border-bottom: none;
        }

        .suggestion-item:hover,
        .suggestion-item.active {
            background: var(--gradient1);
            color: white;
            transform: translateX(5px);
        }

        .suggestion-item:hover .suggestion-highlight,
        .suggestion-item.active .suggestion-highlight {
            color: var(--beige);
        }

        .suggestion-highlight {
            font-weight: bold;
            color: var(--guinda);
        }

        .no-suggestions {
            padding: 1rem;
            text-align: center;
            color: #64748b;
            font-style: italic;
        }

        /* Login Container */
        .login-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            padding: 3rem;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4),
                        0 0 0 1px rgba(255, 255, 255, 0.2) inset;
            max-width: 450px;
            width: 90%;
            animation: slideInUp 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            position: relative;
            z-index: 1;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(100px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Login Logo */
        .login-logo {
            width: 120px;
            height: 120px;
            margin: 0 auto 2rem;
            background: linear-gradient(135deg, #6B2C40, #8B3A52);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 20px 40px rgba(107, 44, 64, 0.3),
                        0 0 0 10px rgba(107, 44, 64, 0.1),
                        0 0 0 20px rgba(107, 44, 64, 0.05);
            position: relative;
        }

        @keyframes pulseLogo {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 20px 40px rgba(107, 44, 64, 0.3),
                            0 0 0 10px rgba(107, 44, 64, 0.1),
                            0 0 0 20px rgba(107, 44, 64, 0.05);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 25px 50px rgba(107, 44, 64, 0.4),
                            0 0 0 15px rgba(107, 44, 64, 0.15),
                            0 0 0 30px rgba(107, 44, 64, 0.08);
            }
        }

        .login-logo::before {
            content: 'üéì';
            font-size: 4rem;
        }

        @keyframes rotateLogo {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        /* Login Title */
        .login-title {
            text-align: center;
            margin-bottom: 1rem;
        }

        .login-title h2 {
            background: linear-gradient(135deg, #6B2C40, #8B3A52);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        @keyframes gradientText {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .login-title p {
            color: #64748b;
            font-size: 1rem;
            margin-bottom: 2rem;
        }

        /* Login Form */
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .form-group {
            position: relative;
        }

        .form-group label {
            display: block;
            color: var(--guinda);
            font-weight: bold;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            font-size: 1.3rem;
            color: var(--guinda);
            transition: all 0.3s ease;
        }

        @keyframes bounceIcon {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .login-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3.5rem;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .login-input:focus {
            outline: none;
            border-color: var(--guinda);
            box-shadow: 0 10px 30px rgba(107, 44, 64, 0.15),
                        0 0 0 4px rgba(107, 44, 64, 0.1);
            transform: translateY(-2px);
        }

        .login-input:focus + .input-icon {
            color: var(--vino);
            transform: scale(1.2) translateY(-5px);
            animation: none;
        }

        /* Role Selection */
        .role-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .role-card {
            padding: 1.5rem;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            position: relative;
            overflow: hidden;
        }

        .role-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(107, 44, 64, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .role-card:hover::before {
            left: 100%;
        }

        .role-card:hover {
            border-color: var(--guinda);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 15px 40px rgba(107, 44, 64, 0.2);
        }

        .role-card.selected {
            border-color: var(--guinda);
            background: linear-gradient(135deg, #6B2C40, #8B3A52);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(107, 44, 64, 0.3);
        }

        .role-card .role-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        @keyframes rotateRole {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(360deg) scale(1.2); }
        }

        .role-card.selected .role-icon {
            animation: bounceSelected 0.5s ease;
        }

        @keyframes bounceSelected {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }

        .role-card .role-name {
            font-weight: bold;
            font-size: 1.1rem;
        }

        /* Login Button */
        .login-btn {
            background: linear-gradient(135deg, #6B2C40, #8B3A52);
            color: white;
            border: none;
            padding: 1.2rem;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            /*text-transform: uppercase;*/
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(107, 44, 64, 0.3);
        }

        .login-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .login-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(107, 44, 64, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-btn span {
            position: relative;
            z-index: 1;
        }

        /* Test Users Info */
        .test-users {
            margin-top: 2rem;
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(37, 99, 235, 0.1));
            border-radius: 15px;
            border: 2px dashed #3b82f6;
        }

        @keyframes pulseInfo {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.4);
            }
            50% {
                box-shadow: 0 0 0 10px rgba(59, 130, 246, 0);
            }
        }

        .test-users h4 {
            color: #1e40af;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }

        .test-users p {
            color: #1e3a8a;
            font-size: 0.85rem;
            margin: 0.3rem 0;
            font-weight: 600;
        }

        /* Loading Animation */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10001;
        }

        .loading-overlay.active {
            display: flex;
        }

        .loading-content {
            text-align: center;
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            border: 8px solid rgba(212, 196, 168, 0.3);
            border-top-color: #D4C4A8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            animation: fadeInOut 1.5s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            background: radial-gradient(circle, #E8DCC4, #D4C4A8);
            border-radius: 50%;
            opacity: 0.3;
            box-shadow: 0 0 10px rgba(212, 196, 168, 0.6);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-100px) rotate(180deg); }
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #6B2C40 0%, #8B3A52 100%);
            padding: 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
            animation: slideDown 0.8s ease;
        }
        
        .header-top {
            background: rgba(255, 255, 255, 0.98);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 3px solid var(--guinda);
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 2rem;
        }
        
        .header-logo-escudo {
            height: 70px;
            width: auto;
            filter: brightness(0.3) contrast(1.8) saturate(0);
        }
        
        .header-logo-sabg {
            height: 60px;
            width: auto;
        }
        
        .header-divider {
            width: 2px;
            height: 70px;
            background: linear-gradient(to bottom, transparent, var(--guinda), transparent);
        }
        
        .header-text {
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .header-title-small {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .header-title-main {
            font-size: 1.3rem;
            color: var(--guinda);
            font-weight: bold;
        }
        
        .header-bottom {
            padding: 1.5rem 2rem;
            text-align: center;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        h1 {
            color: white;
            font-size: 2rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            font-weight: bold;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .subtitle {
            color: #E8DCC4;
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* User Info */
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(107, 44, 64, 0.1);
            padding: 0.7rem 1.2rem;
            border-radius: 50px;
            border: 2px solid var(--guinda);
        }
        
        .user-info span {
            color: var(--guinda);
            font-weight: 600;
        }

        .user-info .user-role {
            background: var(--gradient1);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            font-size: 0.85rem;
        }

        .logout-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .logout-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(239, 68, 68, 0.4);
        }

        /* Main Navigation */
        .main-nav {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 1rem;
            display: flex;
            justify-content: center;
            gap: 1rem;
            position: relative;
            z-index: 100;
            flex-wrap: wrap;
        }

        .nav-item {
            position: relative;
        }

        .main-nav-btn {
            background: var(--gradient1);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .main-nav-btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .main-nav-btn:hover:before {
            width: 300px;
            height: 300px;
        }

        .main-nav-btn:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }

        .main-nav-btn.active {
            background: var(--gradient3);
            transform: scale(1.1);
        }

        .main-nav-btn .arrow {
            transition: transform 0.3s ease;
            font-size: 0.8rem;
        }

        .main-nav-btn.expanded .arrow {
            transform: rotate(180deg);
        }

        /* Dropdown Menu */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(10px);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1rem;
            min-width: 250px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            margin-top: 0.5rem;
        }

        .dropdown-menu.show {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(0);
        }

        .dropdown-item {
            padding: 1rem 1.5rem;
            color: var(--guinda);
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin: 0.3rem 0;
            border: 2px solid transparent;
        }

        .dropdown-item:hover {
            background: var(--gradient1);
            color: white;
            transform: translateX(5px);
            border-color: var(--guinda);
        }

        .dropdown-item.admin-only {
            background: rgba(245, 158, 11, 0.1);
            border: 2px dashed var(--warning);
        }

        .dropdown-item.admin-only:hover {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            border-style: solid;
        }

        .dropdown-item .icon {
            font-size: 1.5rem;
        }

        .dropdown-item .badge {
            background: var(--warning);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            font-size: 0.7rem;
            margin-left: auto;
        }
        /* Container */
        .container {
            max-width: 1600px;
            margin: 2rem auto;
            padding: 2rem;
            position: relative;
            z-index: 10;
        }

        /* Sections */
        .main-section {
            display: none;
        }

        .main-section.active {
            display: block;
            animation: fadeInUp 0.8s ease;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Card */
        .card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        @keyframes cardFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .card:hover {
            transform: translateY(-15px);
            box-shadow: 0 30px 80px rgba(0,0,0,0.4);
        }

        .card h2 {
            background: linear-gradient(135deg, #6B2C40 0%, #D4C4A8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 3px solid;
            border-image: var(--gradient1) 1;
        }

        /* Welcome Section */
        .welcome-hero {
            text-align: center;
            padding: 4rem 2rem;
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            margin-bottom: 3rem;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .welcome-hero h2 {
            font-size: 3rem;
            background: var(--gradient1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1.5rem;
        }

        .welcome-hero p {
            font-size: 1.3rem;
            color: #64748b;
            margin-bottom: 2rem;
            line-height: 1.8;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            border-top: 5px solid var(--guinda);
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .feature-card .icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .feature-card h3 {
            color: var(--guinda);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .feature-card p {
            color: #64748b;
            line-height: 1.6;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 3rem 0;
        }

        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient1);
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: bold;
            background: linear-gradient(135deg, #6B2C40 0%, #D4C4A8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: countUp 2s ease;
        }

        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-label {
            color: #64748b;
            font-size: 1.1rem;
            margin-top: 0.5rem;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 1rem 2rem;
            background: rgba(107, 44, 64, 0.2);
            border: 2px solid var(--guinda);
            border-radius: 10px;
            cursor: pointer;
            color: var(--guinda);
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab:hover {
            background: rgba(107, 44, 64, 0.3);
            transform: translateY(-3px);
        }

        .tab.active {
            background: var(--gradient1);
            color: white;
            transform: scale(1.05);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Admin Controls */
        .admin-panel {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(245, 158, 11, 0.4);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .admin-panel h3 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .admin-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Form */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            color: var(--dark);
            font-weight: bold;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        label .required {
            color: var(--danger);
        }

        input, select, textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--guinda);
            transform: scale(1.01);
            box-shadow: 0 5px 15px rgba(107, 44, 64, 0.3);
        }

        /* Buttons */
        .btn {
            background: var(--gradient1);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            margin: 0.5rem;
            display: inline-block;
            position: relative;
            overflow: hidden;
        }

        .btn:before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover:before {
            width: 400px;
            height: 400px;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #f97316);
        }

        .btn-secondary {
            background: var(--gradient4);
            color: var(--dark);
        }

        /* Table */
        .table-container {
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin: 2rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            min-width: 1200px;
        }

        thead {
            background: var(--gradient1);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 1rem;
            text-align: left;
            font-weight: bold;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        tbody tr {
            transition: all 0.3s ease;
        }

        tbody tr:hover {
            background: linear-gradient(90deg, rgba(107, 44, 64, 0.08), rgba(212, 196, 168, 0.08));
            transform: scale(1.01);
        }

        .estado-rojo {
            color: #ef4444;
            font-weight: bold;
        }

        /* Celdas editables */
        .editable-cell {
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .editable-cell:hover {
            background: #fef3c7 !important;
            box-shadow: inset 0 0 0 2px var(--warning);
        }

        .editable-cell.editing {
            padding: 0.5rem;
            background: white !important;
        }

        .editable-cell input,
        .editable-cell select,
        .editable-cell textarea {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid var(--guinda);
            border-radius: 5px;
            font-size: 0.9rem;
            font-family: inherit;
        }

        .editable-cell textarea {
            min-height: 60px;
            resize: vertical;
        }

        .edit-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--warning);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .editable-cell:hover .edit-icon {
            opacity: 1;
        }

        .editable-disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .editable-disabled:hover {
            background: transparent !important;
            box-shadow: none !important;
        }

        /* Month Grid */
        .month-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .month-card {
            background: var(--gradient1);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .month-card:before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.3), transparent);
            transform: scale(0);
            transition: transform 0.6s ease;
        }

        .month-card:hover:before {
            transform: scale(1);
        }

        .month-card:hover {
            transform: translateY(-10px) rotate(2deg);
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }

        .month-card h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            position: relative;
            z-index: 1;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: scaleIn 0.4s ease;
        }

        @keyframes scaleIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-close {
            float: right;
            font-size: 2rem;
            cursor: pointer;
            color: var(--danger);
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            transform: rotate(90deg) scale(1.2);
        }

        /* Info Box */
        .info-box {
            background: var(--gradient1);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem 0;
            box-shadow: 0 10px 30px rgba(107, 44, 64, 0.4);
        }

        .info-box h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .info-box ul {
            list-style: none;
            padding-left: 0;
        }

        .info-box li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .info-box li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #4ade80;
            font-size: 1.3rem;
            font-weight: bold;
        }

        /* File Upload */
        .file-upload {
            border: 3px dashed #cbd5e1;
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8fafc;
            margin: 1rem 0;
        }

        .file-upload:hover {
            border-color: var(--guinda);
            background: #faf8f3;
            transform: scale(1.02);
        }

        /* Search Box */
        .search-box {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            border: 2px solid var(--guinda);
            border-radius: 10px;
            margin-bottom: 1.5rem;
        }

        /* FAB */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            background: var(--gradient2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 1500;
        }

        .fab:hover {
            transform: scale(1.1) rotate(90deg);
        }

        /* Footer */
        footer {
            background: rgba(30, 41, 59, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem;
            text-align: center;
            color: white;
            margin-top: 3rem;
        }

        footer img {
            height: 50px;
            margin-bottom: 1rem;
            filter: drop-shadow(0 5px 15px rgba(212, 196, 168, 0.6));
        }

        footer p {
            color: #E8DCC4;
            margin: 0.5rem 0;
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }

        /* Subsections */
        .subsection {
            display: none;
        }

        .subsection.active {
            display: block;
            animation: fadeInUp 0.8s ease;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 1.5rem; }
            .subtitle { font-size: 0.9rem; }
            .main-nav-btn { padding: 0.8rem 1.5rem; font-size: 1rem; }
            .card { padding: 1.5rem; }
            .month-grid { grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); }
            th, td { padding: 0.5rem; font-size: 0.8rem; }
            .welcome-hero h2 { font-size: 2rem; }
            .welcome-hero p { font-size: 1.1rem; }
            
            .header-top {
                flex-direction: column;
                gap: 1.5rem;
                padding: 1rem;
            }
            
            .header-left {
                flex-direction: column;
                text-align: center;
                gap: 0.8rem;
            }
            
            .header-right {
                flex-direction: column;
                gap: 1rem;
            }
            
            .header-divider {
                width: 60%;
                height: 2px;
                background: linear-gradient(to right, transparent, var(--guinda), transparent);
            }
            
            .header-logo-escudo {
                height: 50px;
            }
            
            .header-logo-sabg {
                height: 45px;
            }
            
            .header-title-small {
                font-size: 0.75rem;
            }
            
            .header-title-main {
                font-size: 1rem;
            }
            
            .header-bottom {
                padding: 1rem;
            }
            
            .user-info {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        /* ===============================
           ESTILOS MODAL REGISTRO
           =============================== */
        #registroModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10001;
            animation: fadeIn 0.3s ease;
        }
        #restaurarPasswordModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10002;
            animation: fadeIn 0.3s ease;
        }
        
        #restaurarPasswordModal.hidden {
            display: none;
        }
        
        #restaurarPasswordModal .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: scaleIn 0.4s ease;
        }
        
        #restaurarPasswordModal h3 {
            color: var(--guinda);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
        }
        
        #restaurarPasswordModal input {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }
        
        #restaurarPasswordModal input:focus {
            outline: none;
            border-color: var(--guinda);
            box-shadow: 0 5px 15px rgba(107, 44, 64, 0.3);
            transform: scale(1.01);
        }
        
        #restaurarPasswordModal .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        #restaurarPasswordModal .modal-actions button {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        
        #restaurarPasswordModal .modal-actions button:first-child {
            background: var(--gradient1);
            color: white;
        }
        
        #restaurarPasswordModal .modal-actions button:last-child {
            background: #e2e8f0;
            color: var(--dark);
        }
        
        #restaurarPasswordModal .modal-actions button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        #registroModal.hidden {
            display: none;
        }

        #registroModal .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 20px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: scaleIn 0.4s ease;
        }

        #registroModal h3 {
            color: var(--guinda);
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
        }

       #registroModal input {
    width: 100%;
    padding: 1rem;
    margin-bottom: 1rem;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    font-size: 16px;
    transition: all 0.3s ease;
    box-sizing: border-box;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    background-color: white;
}

#registroModal input:focus {
    outline: none;
    border-color: var(--guinda);
    box-shadow: 0 5px 15px rgba(107, 44, 64, 0.3);
    transform: scale(1.01);
}

#registroModal input::placeholder {
    color: #94a3b8;
    opacity: 1;
}

        #registroModal .modal-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        #registroModal .modal-actions button {
            flex: 1;
            padding: 1rem;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            position: relative;
            overflow: hidden;
        }

        #registroModal .modal-actions button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        #registroModal .modal-actions button:hover::before {
            width: 300px;
            height: 300px;
        }

        #registroModal .modal-actions button:first-child {
            background: var(--gradient1);
            color: white;
        }

        #registroModal .modal-actions button:last-child {
            background: #e2e8f0;
            color: var(--dark);
        }

        #registroModal .modal-actions button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        #registroModal .modal-actions button:active {
            transform: translateY(0);
        }

        .register-btn {
            background: linear-gradient(135deg, #10b981, #059669) !important;
            margin-top: 1rem;
            width: 100%;
            color: white;
            border: none;
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        .register-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.4);
        }

        .register-btn:active {
            transform: translateY(0);
        }
        .header-logo-escudo{
  height: 56px;          /* ajusta: 40‚Äì72px t√≠pico en headers */
  width: auto;           /* respeta proporci√≥n */
  max-width: 100%;
  object-fit: contain;   /* evita recortes */
  display: block;        /* quita espacios raros inline */
}
/* OCULTAR botones de tabs (Instructivo / Formulario / Tabla) */
.tabs,
.tabs-container,
.tab-buttons,
.trimestral-tabs {
    display: none !important;
}
    </style>
</head>
<body>
<!-- LOGIN SCREEN -->
    <div id="loginScreen">
        <div class="login-shapes">
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
            <div class="shape"></div>
        </div>

        <div class="login-container">
            <div class="login-logo"></div>
            
            <div class="login-title">
                <h2>SISTEMA DE FORMACI√ìN</h2>
                <p>Secretar√≠a Anticorrupci√≥n y Buen Gobierno</p>
            </div>

            <form class="login-form" onsubmit="event.preventDefault(); loginUsuario();">
                <div class="form-group">
                    <label for="usuario">Usuario</label>
                    <div class="input-wrapper">
                        <input 
                            type="text" 
                            id="usuario" 
                            class="login-input" 
                            placeholder="Ingrese su usuario"
                            autocomplete="username"
                            required
                        >
                        <span class="input-icon">üë§</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="password">CONTRASE√ëA</label>
                    <div class="input-wrapper">
                        <input 
                            type="password" 
                            id="password" 
                            class="login-input" 
                            placeholder="Ingrese su contrase√±a"
                            autocomplete="current-password"
                            required
                        >
                        <span class="input-icon">üîí</span>
                    </div>
                </div>
                <button type="submit" class="login-btn">üöÄ Iniciar sesi√≥n</button>
            <button type="button" class="register-btn" onclick="mostrarRegistro()">
                üìù Registrarse
            </button>
            <button type="button" class="btn-secondary" onclick="mostrarRestaurarPassword()" style="background: linear-gradient(135deg, #64748b, #475569) !important; margin-top: 0.5rem; width: 100%; color: white; border: none; padding: 1rem 2rem; font-size: 1rem; font-weight: bold; border-radius: 15px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 15px rgba(71, 85, 105, 0.3);">
                üîë ¬øOlvidaste tu contrase√±a?
            </button>
            </form>
        </div>
    </div>
    <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">üöÄ Iniciando sesi√≥n...</div>
        </div>
    </div>

    <div class="particles" id="particles"></div>

    <header>
        <div class="header-top">
            <div class="header-left">
                <div class="header-divider"></div>
                <div class="header-text">
                    <div class="header-title-small">Gobierno de M√©xico</div>
                    <div class="header-title-main">Secretar√≠a Anticorrupci√≥n y Buen Gobierno</div>
                </div>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="userName">üë§ Usuario</span>
                    <span class="user-role" id="userRole">Enlace</span>
                    <button class="logout-btn" onclick="logout()">üö™ Salir</button>
                </div>
            </div>
        </div>
        <div class="header-bottom">
            <h1>Sistema de Promoci√≥n de la Formaci√≥n Acad√©mica</h1>
            <p class="subtitle">Direcci√≥n de Capacitaci√≥n y Evaluaci√≥n del Desempe√±o</p>
        </div>
    </header>

    <nav class="main-nav">
        <div class="nav-item">
            <button class="main-nav-btn active" onclick="showMainSection('inicio')">
                üè† Inicio
            </button>
        </div>

        <div class="nav-item">
            <button class="main-nav-btn" onclick="toggleDropdown('dropdownTrimestral', this)">
                üìä Reporte Trimestral Formaci√≥n Acad√©mica
                <span class="arrow">‚ñº</span>
            </button>
            <div id="dropdownTrimestral" class="dropdown-menu">
                <div class="dropdown-item" onclick="showSectionAndTab('trimestral', 'instructivo')" role="button" tabindex="0">
                    <span class="icon">üìñ</span>
                    <span>Instructivo</span>
                </div>
                <div class="dropdown-item" onclick="showSectionAndTab('trimestral', 'formulario')" role="button" tabindex="0">
                    <span class="icon">üìù</span>
                    <span>Formulario de Registro</span>
                </div>
                <div class="dropdown-item admin-only" id="dropdownItemTabla" onclick="showSectionAndTab('trimestral', 'tabla')" role="button" tabindex="0">
                    <span class="icon">üìã</span>
                    <span>Ver Tabla de Registros</span>
                    <span class="badge">ADMIN</span>
                </div>
            </div>
        </div>

        <div class="nav-item">
            <button class="main-nav-btn" onclick="toggleDropdown('dropdownEvidencias', this)">
                üìÑ Reporte de Evidencias Mensuales
                <span class="arrow">‚ñº</span>
            </button>
            <div id="dropdownEvidencias" class="dropdown-menu">
                <div class="dropdown-item" onclick="showSectionAndTab('evidencias', 'registro')" role="button" tabindex="0">
                    <span class="icon">üìÖ</span>
                    <span>Registrar Evidencias</span>
                </div>
                <div class="dropdown-item admin-only" id="dropdownItemRevision" onclick="showSectionAndTab('evidencias', 'revision')" role="button" tabindex="0">
                    <span class="icon">üîç</span>
                    <span>Panel Revisi√≥n DCEVE</span>
                    <span class="badge">ADMIN</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        
        <!-- P√ÅGINA DE INICIO -->
        <div id="inicio" class="main-section active">
            <div class="welcome-hero">
                <h2>üéì Bienvenido al Sistema de Promoci√≥n de la Formaci√≥n Acad√©mica</h2>
                <p>
                    Este sistema integral permite a las dependencias e instituciones de la Administraci√≥n P√∫blica Federal 
                    gestionar, registrar y dar seguimiento a los procesos de formaci√≥n acad√©mica de las personas servidoras p√∫blicas.
                </p>
                <p style="font-size: 1.1rem; color: var(--guinda); font-weight: bold; margin-top: 1rem;">
                    Seleccione una opci√≥n del men√∫ superior para comenzar
                </p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">156</div>
                    <div class="stat-label">Dependencias Registradas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">2,847</div>
                    <div class="stat-label">Servidores P√∫blicos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">89%</div>
                    <div class="stat-label">Tasa de Cumplimiento</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">1,245</div>
                    <div class="stat-label">Registros Activos</div>
                </div>
            </div>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="icon">üìä</div>
                    <h3>Reporte Trimestral</h3>
                    <p>
                        Registre y d√© seguimiento al avance acad√©mico de las personas servidoras p√∫blicas de su dependencia. 
                        Incluye formulario completo con todos los campos requeridos.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="icon">üìÑ</div>
                    <h3>Evidencias Mensuales</h3>
                    <p>
                        Cargue y gestione las evidencias documentales mes con mes. El sistema permite adjuntar archivos PDF 
                        que ser√°n almacenados autom√°ticamente en Google Drive.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="icon">üîç</div>
                    <h3>Panel de Control DCEVE</h3>
                    <p>
                        Los administradores pueden revisar, validar y gestionar todos los registros. Control completo sobre 
                        permisos de edici√≥n y exportaci√≥n de datos.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="icon">üìà</div>
                    <h3>Seguimiento en Tiempo Real</h3>
                    <p>
                        Visualice el estado de avance de cada registro. Los estados desactualizados se marcan autom√°ticamente 
                        para facilitar su identificaci√≥n.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="icon">üì•</div>
                    <h3>Exportaci√≥n de Datos</h3>
                    <p>
                        Descargue la informaci√≥n en m√∫ltiples formatos: Excel, CSV y SQL. Ideal para generar reportes 
                        y an√°lisis personalizados.
                    </p>
                </div>
                <div class="feature-card">
                    <div class="icon">üîí</div>
                    <h3>Seguridad y Permisos</h3>
                    <p>
                        Sistema de roles que garantiza que cada usuario tenga acceso √∫nicamente a las funciones correspondientes 
                        a su nivel de autorizaci√≥n.
                    </p>
                </div>
            </div>

            <div class="card" style="margin-top: 3rem;">
                <h2>üìå Funcionalidades Principales</h2>
                <div class="info-box">
                    <ul>
                        <li>Registro completo de personas servidoras p√∫blicas interesadas en formaci√≥n acad√©mica</li>
                        <li>Seguimiento trimestral del estado de avance educativo</li>
                        <li>Carga mensual de evidencias documentales en formato PDF</li>
                        <li>Panel de revisi√≥n y validaci√≥n para la DCEVE</li>
                        <li>Control de permisos por roles (Enlace, Super Admin)</li>
                        <li>Actualizaci√≥n autom√°tica de estados y registros</li>
                        <li>Exportaci√≥n de datos en m√∫ltiples formatos</li>
                        <li>Notificaciones de estados desactualizados</li>
                        <li>Integraci√≥n con Google Drive para almacenamiento</li>
                        <li>B√∫squeda y filtrado avanzado en tablas</li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- SECCI√ìN: REPORTE TRIMESTRAL -->
        <div id="trimestral" class="main-section">
            <div class="card">
                <h2>üìä Reporte Trimestral de Formaci√≥n Acad√©mica</h2>
                
                <!-- Panel Admin (solo visible para Super Admin) -->
                <div id="adminPanelTrimestral" class="admin-panel hidden">
                <h3>‚öôÔ∏è Panel de Control - Super Administrador</h3>
                <div class="admin-controls">
                    <button class="btn btn-success" onclick="desbloquearEdicion()">
                        üîì Desbloquear Edici√≥n
                    </button>
                    <button class="btn btn-danger" onclick="bloquearEdicion()">
                        üîí Bloquear Edici√≥n
                    </button>
                    <button class="btn btn-warning" onclick="descargarBackup()">
                        üíæ Descargar Backup
                    </button>
                </div>
            </div>
                <div class="tabs">
                    <div class="tab active" onclick="showTrimestralTab('instructivo')" role="button" tabindex="0">
                        üìñ Instructivo
                    </div>
                    <div class="tab" onclick="showTrimestralTab('formulario')" role="button" tabindex="0">
                        üìù Formulario de Registro
                    </div>
                    <div id="tabVerTabla" class="tab hidden" onclick="showTrimestralTab('tabla')" role="button" tabindex="0">
                        üìã Ver Tabla de Registros
                    </div>
                </div>

                <!-- Contenido: Instructivo -->
        <div id="instructivo" class="tab-content active">
            <div class="instructivo">
                <h2><i class="fas fa-book"></i> INSTRUCTIVO PARA EL LLENADO DEL FORMATO</h2>
                <p style="font-style: italic; color: #6c757d; margin-bottom: 30px; font-size: 16px;">
                    "Reporte Trimestral de Avance de Personas Servidoras P√∫blicas Interesadas en Concluir Estudios de Formaci√≥n Acad√©mica"
                </p>

                <div class="note-box">
                    <i class="fas fa-exclamation-triangle"></i> <strong>*Nota:</strong> Se solicita de la manera m√°s atenta respetar los formatos de cada celda a llenar de la pesta√±a FORMACI√ìN ACAD√âMICA. 
                    En caso de tener duda con el registro de los mismos favor de contactar a la Subdirectora de Formaci√≥n y Capacitaci√≥n Institucional A, 
                    al correo <strong>areli.angel@buengobierno.gob.mx</strong>
                </div>

                <h3>Instrucciones Generales</h3>
                <p>A continuaci√≥n se proporcionan las indicaciones para el correcto registro del formato:</p>

                <h3 style="margin-top: 40px;">Definiciones de Campos</h3>

                <div class="definition-item">
                    <strong><i class="fas fa-hashtag"></i> N¬∞</strong>
                    <p>Corresponde al n√∫mero consecutivo de registro.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-calendar-alt"></i> TRIMESTRE</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona el trimestre, no se desplegar√° la lista para seleccionar el Estado de Avance de la persona servidora p√∫blica interesada.</em></p>
                    <p>Corresponde al trimestre en que se registr√≥ a la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-id-card"></i> ID RUSP</strong>
                    <p>Corresponde al n√∫mero de identificaci√≥n de cada persona servidora p√∫blica en el Registro de Servidores P√∫blicos. De no tener el dato, favor de acercarse con el √°rea de Recursos Humanos para su obtenci√≥n y registro.</p>
                    <p><em>*Nota: En caso de ser personal de HONORARIOS, favor de registrar: HONORARIOS.</em></p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-user"></i> PRIMER APELLIDO</strong>
                    <p>Corresponde al primer apellido de la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-user"></i> SEGUNDO APELLIDO</strong>
                    <p>Corresponde al segundo apellido de la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-user"></i> NOMBRE(S)</strong>
                    <p>Corresponde al nombre de la persona servidora p√∫blica interesada. En caso de tener dos nombres, favor de registrar ambos.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-fingerprint"></i> CURP</strong>
                    <p>Corresponde a la Clave √önica de Registro de Poblaci√≥n que contiene 18 caracteres.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-briefcase"></i> NIVEL DE PUESTO</strong>
                    <p>En la celda se visualizar√° una flecha que al seleccionarla desplegar√° una lista con los niveles de puestos. Se deber√° seleccionar el nivel de puesto que le corresponda a la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-layer-group"></i> NIVEL TABULAR</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona el nivel de puesto, no se desplegar√° la lista para seleccionar el nivel tabular al que corresponde la persona servidora p√∫blica interesada.</em></p>
                    <p>En la celda se visualizar√° una flecha que al seleccionarla desplegar√° una lista con los niveles tabulares. Se deber√° seleccionar el nivel tabular que le corresponda a la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-sitemap"></i> RAMO - UR</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona el nivel tabular, no se desplegar√° la lista para seleccionar el Ramo - UR al que corresponde la persona servidora p√∫blica interesada.</em></p>
                    <p>En la celda se visualizar√° una flecha que al seleccionarla desplegar√° una lista con los ramos. Se deber√° seleccionar el ramo que corresponda a la Instituci√≥n en la cual est√© adscrita la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-building"></i> DEPENDENCIA</strong>
                    <p>En la celda se visualizar√° una flecha que al seleccionarla desplegar√° una lista con las Dependencias e Instituciones de la Administraci√≥n P√∫blica Federal. Se deber√° seleccionar la Dependencia o Instituci√≥n donde est√© adscrita la persona servidora p√∫blica interesada.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-envelope"></i> CORREO INSTITUCIONAL</strong>
                    <p>Deber√° registrar directamente el correo institucional de la persona servidora p√∫blica interesada. Favor de corroborar su registro ya que para cualquier comunicaci√≥n, las Instituciones acad√©micas deber√°n tener correcto este dato.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-phone"></i> TEL√âFONO INSTITUCIONAL CON EXTENSI√ìN</strong>
                    <p>Se deber√° registrar directamente el tel√©fono institucional con extensi√≥n de la persona servidora p√∫blica interesada. Favor de corroborar su registro.</p>
                    <p><em>*Nota: En caso de no contar con n√∫mero telef√≥nico institucional, favor de proporcionar un n√∫mero de tel√©fono de contacto directo.</em></p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-graduation-cap"></i> NIVEL EDUCATIVO</strong>
                    <p>En la celda se visualizar√° una flecha que al seleccionarla desplegar√° una lista con los niveles educativos. Se deber√° seleccionar el nivel educativo que la persona servidora p√∫blica est√© interesada en continuar y/o concluir.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-university"></i> INSTITUCI√ìN EDUCATIVA</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona el nivel educativo, no se desplegar√° la lista para seleccionar la instituci√≥n educativa que la persona servidora p√∫blica est√© interesada.</em></p>
                    <p>En la celda de registro se visualizar√° una flecha que al seleccionarla desplegar√° una lista con las instituciones educativas. Se deber√° seleccionar la Instituci√≥n educativa de inter√©s de la persona servidora p√∫blica.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-laptop"></i> MODALIDAD</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona la instituci√≥n educativa, no se desplegar√° la lista para seleccionar la modalidad disponible.</em></p>
                    <p>En la celda de registro, se visualizar√° una flecha que al seleccionarla desplegar√° una lista con las modalidades disponibles de acuerdo a cada Instituci√≥n educativa. Se deber√° seleccionar la modalidad de inter√©s.</p>
                </div>

                <div class="definition-item">
                    <strong><i class="fas fa-chart-line"></i> ESTADO DE AVANCE</strong>
                    <p><em>*Nota: La celda para registro est√° vinculada, si no selecciona el trimestre, no se desplegar√° la lista para seleccionar el Estado de Avance de la persona servidora p√∫blica interesada.</em></p>
                    <p>En la celda de registro se visualizar√° una flecha que al seleccionarla desplegar√° una lista con los estados de avance acad√©mico. Se deber√° seleccionar el estado de avance acad√©mico en que se encuentra la persona servidora p√∫blica.</p>
                    <p><strong>Poner especial atenci√≥n en la opci√≥n:</strong> "Cambi√≥ la instituci√≥n acad√©mica de inter√©s" (√∫nicamente aplicar√° para aquellas personas servidoras p√∫blicas que cambiaron de parecer al elegir Instituci√≥n educativa de inter√©s en el trimestre abril-junio y deber√°n reportar la nueva elecci√≥n en las casillas: Nivel Educativo, Instituci√≥n Educativa y Modalidad).</p>
                </div>

                <h3 style="margin-top: 50px; font-size: 22px;">
                    <i class="fas fa-table"></i> Ejemplos de Registro
                </h3>
                <p style="margin-bottom: 25px; color: #6c757d; font-size: 15px;">
                    A continuaci√≥n se presentan ejemplos pr√°cticos de c√≥mo registrar la informaci√≥n correctamente:
                </p>

                <div style="overflow-x: auto; margin: 30px 0; border-radius: 15px; box-shadow: 0 10px 40px rgba(98, 17, 50, 0.2); animation: slideInUp 0.8s ease-out backwards;">
                    <table style="width: 100%; border-collapse: collapse; min-width: 1200px; background: white;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #621132 0%, #4a0d25 100%); color: white;">
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">N¬∞</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">TRIMESTRE</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">ID RUSP</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">APELLIDOS</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">NOMBRE</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">CURP</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">NIVEL PUESTO</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">NIVEL</th>
                                <th style="padding: 18px 15px; text-align: center; font-weight: 700; font-size: 13px; border: 1px solid rgba(255,255,255,0.2); text-transform: uppercase; letter-spacing: 0.5px;">ESTADO AVANCE</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="animation: fadeInRow 0.8s ease-out 0.2s backwards; transition: all 0.3s ease;">
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-weight: 700; font-size: 16px; background: linear-gradient(135deg, rgba(98, 17, 50, 0.08) 0%, rgba(98, 17, 50, 0.05) 100%); color: #621132;">1</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px; background: rgba(98, 17, 50, 0.02);">ABRIL_JUNIO</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-family: 'Courier New', monospace; color: #621132; font-weight: 800; font-size: 15px; background: rgba(196, 157, 104, 0.1);">123456</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px;">RODR√çGUEZ MART√çNEZ</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px;">JOS√â JUAN</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace; color: #C49D68; font-weight: 800; font-size: 14px; background: rgba(196, 157, 104, 0.05);">ABCDE1234</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-size: 13px; font-weight: 600;">ENLACE_U_HOM√ìLOGO</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-weight: 800; color: #621132; font-size: 15px; background: rgba(196, 157, 104, 0.1);">P13</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, rgba(196, 157, 104, 0.15) 0%, rgba(196, 157, 104, 0.08) 100%); font-weight: 700; font-size: 13px; color: #621132;">CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA</td>
                            </tr>
                            <tr style="animation: fadeInRow 0.8s ease-out 0.4s backwards; transition: all 0.3s ease;">
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-weight: 700; font-size: 16px; background: linear-gradient(135deg, rgba(98, 17, 50, 0.08) 0%, rgba(98, 17, 50, 0.05) 100%); color: #621132;">2</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px; background: rgba(98, 17, 50, 0.02);">JULIO_SEPTIEMBRE</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-family: 'Courier New', monospace; color: #621132; font-weight: 800; font-size: 14px; background: rgba(196, 157, 104, 0.1);">HONORARIOS</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px;">RODRIGUEZ MARTINEZ</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-weight: 600; font-size: 14px;">JOS√â JUAN</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-family: 'Courier New', monospace; color: #C49D68; font-weight: 800; font-size: 14px; background: rgba(196, 157, 104, 0.05);">ABCDE1234</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; font-size: 13px; font-weight: 600;">DIRECTOR_DE_√ÅREA</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; text-align: center; font-weight: 800; color: #621132; font-size: 15px; background: rgba(196, 157, 104, 0.1);">P31</td>
                                <td style="padding: 16px; border: 1px solid #dee2e6; background: linear-gradient(135deg, rgba(40, 167, 69, 0.15) 0%, rgba(40, 167, 69, 0.08) 100%); font-weight: 700; font-size: 13px; color: #28a745;">PERSONA INTERESADA</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="background: linear-gradient(135deg, rgba(98, 17, 50, 0.05) 0%, rgba(196, 157, 104, 0.05) 100%); padding: 30px; border-radius: 15px; margin: 30px 0; border-left: 6px solid #C49D68; animation: slideInLeft 0.8s ease-out 0.6s backwards; box-shadow: 0 5px 20px rgba(0,0,0,0.08);">
                    <h4 style="color: #621132; margin-bottom: 20px; font-size: 20px; font-weight: 800; display: flex; align-items: center;">
                        <i class="fas fa-lightbulb" style="color: #C49D68; margin-right: 12px; font-size: 24px; animation: bounce 2s ease-in-out infinite;"></i>
                        Puntos Clave de los Ejemplos
                    </h4>
                    <ul style="list-style: none; padding: 0; margin: 0;">
                        <li style="padding: 15px 0; border-bottom: 1px solid rgba(98, 17, 50, 0.1); display: flex; align-items: flex-start; animation: slideInLeft 0.6s ease-out 0.8s backwards;">
                            <i class="fas fa-check-circle" style="color: #28a745; margin-right: 15px; font-size: 20px; margin-top: 3px; min-width: 20px;"></i>
                            <span style="line-height: 1.6;"><strong style="color: #621132;">Ejemplo 1:</strong> Muestra c√≥mo registrar un ID RUSP num√©rico (123456) y el estado cuando una persona cambi√≥ de instituci√≥n educativa de inter√©s</span>
                        </li>
                        <li style="padding: 15px 0; border-bottom: 1px solid rgba(98, 17, 50, 0.1); display: flex; align-items: flex-start; animation: slideInLeft 0.6s ease-out 0.9s backwards;">
                            <i class="fas fa-check-circle" style="color: #28a745; margin-right: 15px; font-size: 20px; margin-top: 3px; min-width: 20px;"></i>
                            <span style="line-height: 1.6;"><strong style="color: #621132;">Ejemplo 2:</strong> Muestra c√≥mo registrar personal de HONORARIOS (escribir la palabra completa HONORARIOS en el campo ID RUSP)</span>
                        </li>
                        <li style="padding: 15px 0; border-bottom: 1px solid rgba(98, 17, 50, 0.1); display: flex; align-items: flex-start; animation: slideInLeft 0.6s ease-out 1s backwards;">
                            <i class="fas fa-info-circle" style="color: #007bff; margin-right: 15px; font-size: 20px; margin-top: 3px; min-width: 20px;"></i>
                            <span style="line-height: 1.6;"><strong style="color: #621132;">Formato de trimestre:</strong> Usar guion bajo (_) entre meses: <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">ABRIL_JUNIO</code>, <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">JULIO_SEPTIEMBRE</code></span>
                        </li>
                        <li style="padding: 15px 0; border-bottom: 1px solid rgba(98, 17, 50, 0.1); display: flex; align-items: flex-start; animation: slideInLeft 0.6s ease-out 1.1s backwards;">
                            <i class="fas fa-info-circle" style="color: #007bff; margin-right: 15px; font-size: 20px; margin-top: 3px; min-width: 20px;"></i>
                            <span style="line-height: 1.6;"><strong style="color: #621132;">Nivel de puesto:</strong> Usar el formato con guiones bajos: <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">ENLACE_U_HOM√ìLOGO</code>, <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">DIRECTOR_DE_√ÅREA</code></span>
                        </li>
                        <li style="padding: 15px 0; display: flex; align-items: flex-start; animation: slideInLeft 0.6s ease-out 1.2s backwards;">
                            <i class="fas fa-info-circle" style="color: #007bff; margin-right: 15px; font-size: 20px; margin-top: 3px; min-width: 20px;"></i>
                            <span style="line-height: 1.6;"><strong style="color: #621132;">Nivel tabular:</strong> Formato simple con letra may√∫scula y n√∫mero: <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">P13</code>, <code style="background: rgba(98,17,50,0.1); padding: 3px 8px; border-radius: 5px; font-family: monospace; color: #621132; font-weight: 700;">P31</code></span>
                        </li>
                    </ul>
                </div>

                <div class="note-box" style="margin-top: 40px;">
                    <i class="fas fa-check-circle"></i> <strong>Importante:</strong> Todos los campos marcados con asterisco (*) son obligatorios. 
                    Aseg√∫rese de llenar correctamente cada uno de ellos antes de enviar el formulario.
                </div>
            </div>
        </div>

                <!-- TAB: FORMULARIO -->
                <div id="formulario" class="tab-content">
                    <h3 style="color: var(--guinda); margin-bottom: 1.5rem;">üë§ Datos del Enlace de Formaci√≥n Acad√©mica</h3>
                    
                    <form id="trimestralForm" onsubmit="event.preventDefault(); guardarRegistroTrimestral();">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="enlace_nombre">Nombre(s) <span class="required">*</span></label>
                                <input type="text" name="enlace_nombre" required id="enlace_nombre">
                            </div>
                            <div class="form-group">
                                <label for="enlace_apellido1">Primer Apellido <span class="required">*</span></label>
                                <input type="text" name="enlace_apellido1" required id="enlace_apellido1">
                            </div>
                            <div class="form-group">
                                <label for="enlace_apellido2">Segundo Apellido <span class="required">*</span></label>
                                <input type="text" name="enlace_apellido2" required id="enlace_apellido2">
                            </div>
                            <div class="form-group">
                                <label for="enlace_correo">Correo Institucional <span class="required">*</span></label>
                                <input type="email" name="enlace_correo" required id="enlace_correo">
                            </div>
                            <div class="form-group">
                                <label for="enlace_telefono">Tel√©fono Institucional con Extensi√≥n <span class="required">*</span></label>
                                <input type="tel" name="enlace_telefono" placeholder="55-1234-5678 ext. 123" required id="enlace_telefono">
                            </div>
                        </div>

                        <h3 style="color: var(--guinda); margin: 2rem 0 1.5rem;">üìù Registro de Persona Servidora P√∫blica Interesada</h3>
                        
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="trimestre">Trimestre <span class="required">*</span></label>
                                <select name="trimestre" required id="trimestre">
                                    <option value="">Seleccione...</option>
                                    <option value="ABRIL_JUNIO">ABRIL - JUNIO</option>
                                    <option value="JULIO_SEPTIEMBRE">JULIO - SEPTIEMBRE</option>
                                    <option value="OCTUBRE_DICIEMBRE">OCTUBRE - DICIEMBRE</option>
                                    <option value="ENERO_MARZO">ENERO - MARZO</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="id_rusp">ID RUSP <span class="required">*</span></label>
                                <input type="text" name="id_rusp" placeholder="N√∫mero de identificaci√≥n" required id="id_rusp">
                            </div>
                            <div class="form-group">
                                <label for="primer_apellido">Primer Apellido <span class="required">*</span></label>
                                <input type="text" name="primer_apellido" required id="primer_apellido">
                            </div>
                            <div class="form-group">
                                <label for="segundo_apellido">Segundo Apellido <span class="required">*</span></label>
                                <input type="text" name="segundo_apellido" required id="segundo_apellido">
                            </div>
                            <div class="form-group">
                                <label for="nombre">Nombre(s) <span class="required">*</span></label>
                                <input type="text" name="nombre" required id="nombre">
                            </div>
                            <div class="form-group">
                                <label for="curp">CURP <span class="required">*</span></label>
                                <input type="text" name="curp" maxlength="18" pattern="[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9]{2}" required id="curp">
                            </div>
                            <div class="form-group">
                                <label for="nivel_puesto">Nivel de Puesto <span class="required">*</span></label>
                                <select name="nivel_puesto" required id="nivel_puesto">
                                    <option value="">Seleccione...</option>
                                    <option value="PUESTO_OPERATIVO_U_HOM√ìLOGO">PUESTO OPERATIVO U HOM√ìLOGO</option>
                                    <option value="ENLACE_U_HOM√ìLOGO">ENLACE U HOM√ìLOGO</option>
                                    <option value="JEFE_DE_DEPARTAMENTO_U_HOM√ìLOGO">JEFE DE DEPARTAMENTO U HOM√ìLOGO</option>
                                    <option value="SUBDIRECTOR_DE_√ÅREA_U_HOM√ìLOGO">SUBDIRECTOR DE √ÅREA U HOM√ìLOGO</option>
                                    <option value="DIRECTOR_DE_√ÅREA_U_HOM√ìLOGO">DIRECTOR DE √ÅREA U HOM√ìLOGO</option>
                                    <option value="COORDINADOR">COORDINADOR</option>
                                    <option value="DIRECTOR_GENERAL_U_HOM√ìLOGO">DIRECTOR GENERAL U HOM√ìLOGO</option>
                                    <option value="TITULAR_DE_UNIDAD_O_SUPERIOR">TITULAR DE UNIDAD O SUPERIOR</option>
                                    <option value="OTRO">OTRO</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="nivel_tabular">Nivel Tabular <span class="required">*</span></label>
                                <select name="nivel_tabular" required id="nivel_tabular">
                                    <option value="">Seleccione...</option>
                                    <option value="P11">P11</option>
                                    <option value="P12">P12</option>
                                    <option value="P13">P13</option>
                                    <option value="P21">P21</option>
                                    <option value="P23">P23</option>
                                    <option value="P31">P31</option>
                                    <option value="P32">P32</option>
                                    <option value="P33">P33</option>
                                    <option value="O11">O11</option>
                                    <option value="O21">O21</option>
                                    <option value="O23">O23</option>
                                    <option value="O31">O31</option>
                                    <option value="O32">O32</option>
                                    <option value="O33">O33</option>
                                    <option value="N11">N11</option>
                                    <option value="N21">N21</option>
                                </select>
                            </div>
                            <div class="form-group" style="position: relative;">
                                <label for="ramoUrInput">Ramo - UR <span class="required">*</span></label>
                                <input type="text" name="ramo_ur" id="ramoUrInput" placeholder="Busque o escriba el Ramo-UR (Ej: 13-J3A)" autocomplete="off" required>
                                <div id="ramoUrSuggestions" class="autocomplete-suggestions"></div>
                            </div>
                            <div class="form-group" style="position: relative;">
                                <label for="dependenciaInput">Dependencia <span class="required">*</span></label>
                                <input type="text" name="dependencia" id="dependenciaInput" placeholder="Busque o escriba la Dependencia" autocomplete="off" required>
                                <div id="dependenciaSuggestions" class="autocomplete-suggestions"></div>
                            </div>
                            <div class="form-group">
                                <label for="correo_institucional">Correo Institucional <span class="required">*</span></label>
                                <input type="email" name="correo_institucional" required id="correo_institucional">
                            </div>
                            <div class="form-group">
                                <label for="telefono_institucional">Tel√©fono Institucional con Extensi√≥n <span class="required">*</span></label>
                                <input type="tel" name="telefono_institucional" required id="telefono_institucional">
                            </div>
                            <div class="form-group">
                                <label for="nivel_educativo">Nivel Educativo <span class="required">*</span></label>
                                <select name="nivel_educativo" required id="nivel_educativo">
                                    <option value="">Seleccione...</option>
                                    <option value="PRIMARIA">PRIMARIA</option>
                                    <option value="SECUNDARIA">SECUNDARIA</option>
                                    <option value="BACHILLERATO">BACHILLERATO</option>
                                    <option value="LICENCIATURA">LICENCIATURA</option>
                                    <option value="ESPECIALIDAD">ESPECIALIDAD</option>
                                    <option value="MAESTR√çA">MAESTR√çA</option>
                                    <option value="DOCTORADO">DOCTORADO</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="institucion_educativa">Instituci√≥n Educativa <span class="required">*</span></label>
                                <select name="institucion_educativa" required id="institucion_educativa">
                                    <option value="">Seleccione...</option>
                                    <option>INSTITUTO NACIONAL PARA LA EDUCACI√ìN DE ADULTOS (INEA)</option>
                                    <option>COLEGIO DE BACHILLERES (COLBACH)</option>
                                    <option>UNIVERSIDAD ABIERTA Y A DISTANCIA DE M√âXICO (UNADM)</option>
                                    <option>UNIVERSIDAD NACIONAL ROSARIO CASTELLANOS (UNRC)</option>
                                    <option>TECNOL√ìGICO NACIONAL DE M√âXICO (TECNM)</option>
                                    <option>UNIVERSIDAD INTERNACIONAL DE LA RIOJA (UNIR)</option>
                                    <option>SECRETAR√çA DE EDUCACI√ìN P√öBLICA</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="modalidad">Modalidad <span class="required">*</span></label>
                                <select name="modalidad" required id="modalidad">
                                    <option value="">Seleccione...</option>
                                    <option value="GU√çA DE ESTUDIO ‚Äì EXAMEN √öNICO (INEA)">GU√çA DE ESTUDIO ‚Äì EXAMEN √öNICO (INEA)</option>
                                    <option value="APRENDE INEA EN L√çNEA">APRENDE INEA EN L√çNEA</option>
                                    <option value="PRESENCIAL MEV (INEA)">PRESENCIAL MEV (INEA)</option>
                                    <option value="CERTIFICACI√ìN POR EVALUACIONES PARCIALES (COLBACH)">CERTIFICACI√ìN POR EVALUACIONES PARCIALES (COLBACH)</option>
                                    <option value="SISTEMA DE ENSE√ëANZA ABIERTA SEA (COLBACH)">SISTEMA DE ENSE√ëANZA ABIERTA SEA (COLBACH)</option>
                                    <option value="NO ESCOLARIZADA/VIRTUAL">NO ESCOLARIZADA/VIRTUAL</option>
                                    <option value="A DISTANCIA">A DISTANCIA</option>
                                    <option value="PRESENCIAL">PRESENCIAL</option>
                                    <option value="ESCOLARIZADA">ESCOLARIZADA</option>
                                    <option value="MIXTO">MIXTO</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="estado_avance">Estado de Avance <span class="required">*</span></label>
                                <select name="estado_avance" required id="estado_avance">
                                    <option value="">Seleccione...</option>
                                    <option value="PERSONA INTERESADA">PERSONA INTERESADA</option>
                                    <option value="PERSONA INSCRITA">PERSONA INSCRITA</option>
                                    <option value="PERSONA CURSANDO NIVEL EDUCATIVO">PERSONA CURSANDO NIVEL EDUCATIVO</option>
                                    <option value="PERSONA QUE CONCLUY√ì SUS ESTUDIOS">PERSONA QUE CONCLUY√ì SUS ESTUDIOS</option>
                                    <option value="PERSONA EN PROCESO DE TITULACI√ìN">PERSONA EN PROCESO DE TITULACI√ìN</option>
                                    <option value="PERSONA SUSPENDIDA">PERSONA SUSPENDIDA</option>
                                    <option value="CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS">CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS</option>
                                    <option value="PERSONA QUE DESERT√ì">PERSONA QUE DESERT√ì</option>
                                    <option value="OTRA">OTRA</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="observaciones">Observaciones</label>
                            <textarea name="observaciones" rows="4" placeholder="Ingrese observaciones adicionales (opcional)" id="observaciones"></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" class="btn">üíæ Guardar Registro</button>
                    </div>
                    </form>
                </div>
                <!-- TAB: TABLA DE REGISTROS (Solo visible para Super Admin) -->
                <div id="tabla" class="tab-content">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 1rem;">
                        <h3 style="color: var(--guinda);">üìã Tabla de Registros - Control DCEVE</h3>
                    </div>
                    <input type="text" id="searchTableTrimestral" class="search-box" placeholder="üîç Buscar en la tabla...">
                   <div style="margin-bottom: 1rem;">
                    <button class="btn btn-success" onclick="exportData('excel')">üì• Exportar a JSON (Excel compatible)</button>
                    <button class="btn btn-success" onclick="exportData('csv')">üì• Exportar a CSV</button>
                    <button class="btn btn-secondary" onclick="exportData('sql')" disabled style="opacity: 0.5; cursor: not-allowed;">üì• Exportar a SQL (Pr√≥ximamente)</button>
                </div>
                    <div id="estadoEdicion" style="padding: 1rem; background: var(--gradient1); color: white; border-radius: 10px; margin-bottom: 1rem; text-align: center; font-weight: bold;">
                        üîí Edici√≥n BLOQUEADA
                    </div>

                    <div class="table-container">
                        <table id="registrosTable">
                            <thead>
                                <tr>
                                    <th>N¬∞</th>
                                    <th>TRIMESTRE</th>
                                    <th>ID RUSP</th>
                                    <th>PRIMER APELLIDO</th>
                                    <th>SEGUNDO APELLIDO</th>
                                    <th>NOMBRE(S)</th>
                                    <th>CURP</th>
                                    <th>NIVEL DE PUESTO</th>
                                    <th>NIVEL TABULAR</th>
                                    <th>RAMO - UR</th>
                                    <th>DEPENDENCIA</th>
                                    <th>CORREO INSTITUCIONAL</th>
                                    <th>TEL√âFONO</th>
                                    <th>NIVEL EDUCATIVO</th>
                                    <th>INSTITUCI√ìN EDUCATIVA</th>
                                    <th>MODALIDAD</th>
                                    <th>ESTADO DE AVANCE</th>
                                    <th>OBSERVACIONES</th>
                                    <th>ENLACE NOMBRE(S)</th>
                                    <th>ENLACE PRIMER APELLIDO</th>
                                    <th>ENLACE SEGUNDO APELLIDO</th>
                                    <th>ENLACE CORREO</th>
                                    <th>ENLACE TEL√âFONO</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>ABRIL_JUNIO</td>
                                    <td>123456</td>
                                    <td>RODR√çGUEZ</td>
                                    <td>MART√çNEZ</td>
                                    <td>JOS√â JUAN</td>
                                    <td>ABCDE1234</td>
                                    <td>ENLACE U HOM√ìLOGO</td>
                                    <td>P13</td>
                                    <td>13-J3A</td>
                                    <td>ADMIN. SIST. PORTUARIO NAL. ALTAMIRA</td>
                                    <td>correo@institucional.gob.mx</td>
                                    <td>12345 EXT. 123</td>
                                    <td class="editable-cell" data-field="nivel_educativo" onclick="makeEditable(this)" role="button" tabindex="0">
                                        SECUNDARIA
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="institucion_educativa" onclick="makeEditable(this)" role="button" tabindex="0">
                                        INEA
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="modalidad" onclick="makeEditable(this)" role="button" tabindex="0">
                                        APRENDE INEA EN L√çNEA
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell estado-rojo" data-field="estado_avance" onclick="makeEditable(this)" role="button" tabindex="0">
                                        CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="observaciones" onclick="makeEditable(this)" role="button" tabindex="0">
                                        En proceso
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td>Mar√≠a</td>
                                    <td>Gonz√°lez</td>
                                    <td>P√©rez</td>
                                    <td>correo@institucional.gob.mx</td>
                                    <td>55-5555-5555</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>JULIO_SEPTIEMBRE</td>
                                    <td>HONORARIOS</td>
                                    <td>RODRIGUEZ</td>
                                    <td>MARTINEZ</td>
                                    <td>JOS√â JUAN</td>
                                    <td>ABCDE1234</td>
                                    <td>DIRECTOR DE √ÅREA U HOM√ìLOGO</td>
                                    <td>P31</td>
                                    <td>13-J2R</td>
                                    <td>ADMIN. SIST. PORTUARIO NAL. PROGRESO</td>
                                    <td>correo@institucional.gob.mx</td>
                                    <td>12345 EXT. 123</td>
                                    <td class="editable-cell" data-field="nivel_educativo" onclick="makeEditable(this)" role="button" tabindex="0">
                                        LICENCIATURA
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="institucion_educativa" onclick="makeEditable(this)" role="button" tabindex="0">
                                        TECNM
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="modalidad" onclick="makeEditable(this)" role="button" tabindex="0">
                                        MIXTO
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="estado_avance" onclick="makeEditable(this)" role="button" tabindex="0">
                                        PERSONA INTERESADA
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td class="editable-cell" data-field="observaciones" onclick="makeEditable(this)" role="button" tabindex="0">
                                        -
                                        <span class="edit-icon">‚úèÔ∏è</span>
                                    </td>
                                    <td>Juan</td>
                                    <td>L√≥pez</td>
                                    <td>Ram√≠rez</td>
                                    <td>correo@institucional.gob.mx</td>
                                    <td>55-6666-6666</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="info-box" style="margin-top: 2rem;">
                        <h3>‚ö†Ô∏è Notas Importantes sobre la Tabla</h3>
                        <ul>
                            <li>Los estados de avance desactualizados se visualizan en color ROJO</li>
                            <li>Las celdas editables muestran un icono de l√°piz ‚úèÔ∏è al pasar el mouse</li>
                            <li>Haga clic en una celda editable para modificar su contenido</li>
                            <li>Los cambios se guardan autom√°ticamente al presionar Enter o al salir del campo</li>
                            <li>La DCEVE controla el bloqueo/desbloqueo de edici√≥n de datos</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN: EVIDENCIAS MENSUALES -->
        <div id="evidencias" class="main-section">
            
            <!-- Sub-secci√≥n: Registro de Evidencias -->
            <div id="registro" class="subsection active">
                <div class="card">
                    <h2>üìÑ Reporte de Evidencias Mensuales</h2>
                    
                    <!-- Panel Admin (solo visible para Super Admin) -->
                    <div id="adminPanelEvidencias" class="admin-panel hidden">
                        <h3>‚öôÔ∏è Panel de Control - Super Administrador</h3>
                        <div class="admin-controls">
                            <button class="btn btn-warning" onclick="togglePanelRevision()">
                                üëÅÔ∏è Mostrar/Ocultar Panel de Revisi√≥n
                            </button>
                        </div>
                    </div>

                    <div class="info-box">
                        <h3>üìù Instrucciones</h3>
                        <ul>
                            <li>Seleccione el mes para registrar las evidencias correspondientes</li>
                            <li>Las evidencias ser√°n almacenadas en una carpeta de Google Drive correspondiente al mes de entrega</li>
                            <li>El archivo debe ser en formato PDF √∫nicamente</li>
                            <li>Nombrar el archivo con las siglas de la dependencia y el mes (Ejemplo: INALI_noviembre, IMSS_noviembre)</li>
                            <li>Complete todos los datos del Enlace de Formaci√≥n Acad√©mica</li>
                        </ul>
                    </div>

                    <h3 style="color: var(--guinda); margin: 2rem 0 1.5rem;">üìÖ Seleccione el Mes</h3>
                    
                    <div class="month-grid">
                        <div class="month-card" onclick="openMonthModal('Enero')" style="background: var(--gradient1);" role="button" tabindex="0">
                            <h3>‚ùÑÔ∏è Enero</h3>
                            <p>2025</p>
                        </div>
                        <div class="month-card" onclick="openMonthModal('Febrero')" style="background: var(--gradient2);" role="button" tabindex="0">
                            <h3>üíù Febrero</h3>
                            <p>2025</p>
                        </div>
                        <div class="month-card" onclick="openMonthModal('Marzo')" style="background: var(--gradient3);" role="button" tabindex="0">
                            <h3>üå∏ Marzo</h3>
                            <p>2025</p>
                        </div>
                        <div class="month-card" onclick="openMonthModal('Abril')" style="background: var(--gradient4);" role="button" tabindex="0">
                            <h3>üåº Abril</h3>
                            <p>2025</p>
                        </div>
                        <div class="month-card" onclick="openMonthModal('Mayo')" style="background: var(--gradient1);" role="button" tabindex="0">
                            <h3>üåª Mayo</h3>
                            <p>2025</p>
                        </div>
                        <div class="month-card" onclick="openMonthModal('Junio')" style="background: var(--gradient2);" role="button" tabindex="0">
                            <h3>‚òÄÔ∏è Junio</h3>
                            <p>2025</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sub-secci√≥n: Panel de Revisi√≥n DCEVE -->
            <div id="revision" class="subsection">
                <div class="card">
                    <h2>üîç Revisi√≥n de Evidencias Mensuales - Panel DCEVE</h2>
                    
                    <div class="info-box">
                        <h3>üìã Panel de Control DCEVE</h3>
                        <ul>
                            <li>Visualice las evidencias registradas por las dependencias</li>
                            <li>Descargue los archivos PDF adjuntos</li>
                            <li>Marque como "Completado" o "Sin completar" seg√∫n la revisi√≥n</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Registro de Evidencias -->
    <div id="monthModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()" role="button" tabindex="0">&times;</span>
            <h2 id="modalTitle" style="color: var(--guinda); margin-bottom: 2rem;">Registro de Evidencias Mensuales</h2>
            
            <form id="evidenciaForm" onsubmit="event.preventDefault(); alert('‚úÖ Evidencia enviada exitosamente!'); closeModal(); this.reset();">
                <h3 style="color: var(--guinda); margin-bottom: 1.5rem;">üìã Datos del Enlace de Formaci√≥n Acad√©mica que Registra</h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label>Nombre(s) <span class="required">*</span></label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>Primer Apellido <span class="required">*</span></label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>Segundo Apellido <span class="required">*</span></label>
                        <input type="text" required>
                    </div>
                    <div class="form-group">
                        <label>Correo Institucional <span class="required">*</span></label>
                        <input type="email" required>
                    </div>
                </div>

                <div class="form-group">
                    <label>üìé Carga de Archivo PDF <span class="required">*</span></label>
                    <div class="file-upload" id="fileUpload" onclick="document.getElementById('pdfFile').click()">
                        <p style="font-size: 3rem; margin-bottom: 1rem;">üìÑ</p>
                        <p style="font-size: 1.2rem; font-weight: bold;">Haga clic o arrastre el archivo PDF aqu√≠</p>
                        <p style="color: #64748b; margin-top: 0.5rem;">Solo se permiten archivos PDF</p>
                        <input type="file" id="pdfFile" accept=".pdf" style="display: none;" required>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 2rem;">
                    <button type="submit" class="btn">üì§ Enviar Evidencia</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal()">‚ùå Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ‚¨áÔ∏è MODAL REGISTRO USUARIO ‚¨áÔ∏è -->
 <div id="registroModal" class="modal hidden">
    <div class="modal-content">
        <h3>üìù Registro de Usuario</h3>
        
        <form id="formRegistro" onsubmit="event.preventDefault(); registrarUsuario();">
            <input
                id="reg_curp"
                type="tel"
                placeholder="CURP (18 caracteres)"
                required
                maxlength="18"
                minlength="18"
                style="text-transform: uppercase;"
                autocomplete="off"
                autocorrect="off"
                autocapitalize="characters"
                inputmode="text"
            />
            <input
                id="reg_nombre"
                type="text"
                placeholder="Nombre(s)"
                required
            />
            <input
                id="reg_primer_apellido"
                type="text"
                placeholder="Primer Apellido"
                required
            />
            <input
                id="reg_segundo_apellido"
                type="text"
                placeholder="Segundo Apellido"
                required
            />
            <input
                id="reg_correo"
                type="email"
                placeholder="Correo Electr√≥nico"
                required
            />
            <input
                id="reg_dependencia"
                type="text"
                placeholder="Dependencia / Instituci√≥n"
                required
            />
            <input
                id="reg_usuario"
                type="text"
                placeholder="Usuario"
                required
                minlength="3"
                maxlength="20"
                style="text-transform: uppercase;"
            />
            <input
                id="reg_password"
                type="password"
                placeholder="Contrase√±a (m√≠nimo 6 caracteres)"
                required
                minlength="6"
            />
            <div class="modal-actions">
                <button type="submit">Registrar</button>
                <button type="button" onclick="cerrarRegistro()">Cancelar</button>
            </div>
        </form>
    </div>
</div>
    <!-- ‚¨áÔ∏è MODAL RESTAURAR CONTRASE√ëA ‚¨áÔ∏è -->
    <div id="restaurarPasswordModal" class="modal hidden">
        <div class="modal-content">
            <h3>üîë Restaurar Contrase√±a</h3>
            
            <form id="formRestaurarPassword" onsubmit="event.preventDefault(); restaurarPassword();">
                <p style="color: #64748b; margin-bottom: 1.5rem; text-align: center;">
                    Ingresa tu usuario y te enviaremos instrucciones para restaurar tu contrase√±a.
                </p>
                
                <input
                    id="restore_usuario"
                    type="text"
                    placeholder="Usuario"
                    required
                    minlength="3"
                />
                
                <input
                    id="restore_email"
                    type="email"
                    placeholder="Correo institucional"
                    required
                />
                
                <div class="modal-actions">
                    <button type="submit">Enviar Instrucciones</button>
                    <button type="button" onclick="cerrarRestaurarPassword()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
    <div class="fab" onclick="window.scrollTo({top: 0, behavior: 'smooth'})" role="button" tabindex="0">‚¨ÜÔ∏è</div>
    <footer>
        <img src="data:image/webp;base64,UklGRuglAABXRUJQVlA4WAoAAAAwAAAAnAEAPQAASUNDUMgBAAAAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAH4AABAAEAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADY=" alt="Gobierno de M√©xico - SABG">
        <p style="font-size: 1.2rem; font-weight: bold;">Gobierno de M√©xico</p>
        <p>Secretar√≠a Anticorrupci√≥n y Buen Gobierno</p>
        <p>Sistema de Promoci√≥n de la Formaci√≥n Acad√©mica</p>
        <p style="margin-top: 1rem; color: #94a3b8;">¬© 2025 - Todos los derechos reservados</p>
    </footer>
        <script>
    // ========================================
    // SISTEMA DE ROLES Y VARIABLES GLOBALES
    // ========================================
    let userRole = 'enlace';
    let edicionBloqueada = true;
    let userDependencia = null;
    let userName = '';

    // Base de datos de usuarios (en producci√≥n esto vendr√≠a de un backend)
    const usuarios = {
        // Super Admin
        'ADMIN': { 
            password: 'admin2024', 
            role: 'superadmin',
            dependencia: null,
            nombre: 'Administrador'
        },
        // Dependencias
        'SABG': { 
            password: 'sabg2024', 
            role: 'enlace',
            dependencia: 'SECRETAR√çA ANTICORRUPCI√ìN Y BUEN GOBIERNO',
            nombre: 'Enlace SABG'
        },
        'SCT': { 
            password: 'sct2024', 
            role: 'enlace',
            dependencia: 'SECRETAR√çA DE COMUNICACIONES Y TRANSPORTES',
            nombre: 'Enlace SCT'
        },
        'SHCP': { 
            password: 'shcp2024', 
            role: 'enlace',
            dependencia: 'SECRETAR√çA DE HACIENDA Y CR√âDITO P√öBLICO',
            nombre: 'Enlace SHCP'
        },
        'SEP': { 
            password: 'sep2024', 
            role: 'enlace',
            dependencia: 'SECRETAR√çA DE EDUCACI√ìN P√öBLICA',
            nombre: 'Enlace SEP'
        },
        'ALTAMIRA': { 
            password: 'altamira2024', 
            role: 'enlace',
            dependencia: 'ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL ALTAMIRA',
            nombre: 'Enlace Altamira'
        },
        'PROGRESO': { 
            password: 'progreso2024', 
            role: 'enlace',
            dependencia: 'ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL PROGRESO',
            nombre: 'Enlace Progreso'
        }
    };

    // ========================================
    // FUNCIONES DE AUTENTICACI√ìN
    // ========================================
     // Control Modal Registro
    function mostrarRegistro() {
        console.log("üìù Abriendo modal de registro");
        document.getElementById("registroModal").classList.remove("hidden");
    }

    function cerrarRegistro() {
        console.log("‚ùå Cerrando modal de registro");
        document.getElementById("registroModal").classList.add("hidden");
        document.getElementById("reg_usuario").value = "";
        document.getElementById("reg_institucion").value = "";
        document.getElementById("reg_password").value = "";
    }

    // ========================================
    // RESTAURAR CONTRASE√ëA
    // ========================================
    
    function mostrarRestaurarPassword() {
        console.log("üîë Abriendo modal de restaurar contrase√±a");
        document.getElementById("restaurarPasswordModal").classList.remove("hidden");
    }

    function cerrarRestaurarPassword() {
        console.log("‚ùå Cerrando modal de restaurar contrase√±a");
        document.getElementById("restaurarPasswordModal").classList.add("hidden");
        document.getElementById("restore_usuario").value = "";
        document.getElementById("restore_email").value = "";
    }

    async function restaurarPassword() {
        const usuarioInput = document.getElementById("restore_usuario");
        const emailInput = document.getElementById("restore_email");

        const usuario = usuarioInput.value.trim();
        const email = emailInput.value.trim();

        if (!usuario || !email) {
            alert("‚ùå Completa todos los campos");
            return;
        }

        try {
            alert(`üìß Se han enviado las instrucciones para restaurar tu contrase√±a al correo:\n\n${email}\n\nPor favor revisa tu bandeja de entrada y spam.\n\nNota: Esta funcionalidad est√° en desarrollo. Por favor contacta al administrador.`);
            cerrarRestaurarPassword();
            
        } catch (error) {
            console.error("‚ùå Error al restaurar:", error);
            alert("‚ùå Error de conexi√≥n con el servidor");
        }
    }
            // ========================================
// LOGIN DE USUARIO
// ========================================
async function loginUsuario() {
    const usuario = document.getElementById("usuario").value.trim();
    const password = document.getElementById("password").value.trim();

    if (!usuario || !password) {
        alert("‚ùå Por favor completa todos los campos");
        return;
    }

    try {
        document.getElementById('loadingOverlay').classList.add('active');
        
        const response = await fetch('/api/auth/login', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({ usuario, password })
        });

        const data = await response.json();

        if (data.success) {
            userRole = data.rol;
            userName = data.nombre;
            userDependencia = data.dependencia;

            document.getElementById('userName').textContent = `üë§ ${data.nombre}`;
            document.getElementById('userRole').textContent = data.rol === 'superadmin' ? 'Super Admin' : 'Enlace';

            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('loadingOverlay').classList.remove('active');

            if (userRole === 'superadmin') {
                document.getElementById('adminPanelTrimestral').classList.remove('hidden');
                document.getElementById('adminPanelEvidencias').classList.remove('hidden');
                document.getElementById('tabVerTabla').classList.remove('hidden');
                document.getElementById('dropdownItemTabla').classList.remove('admin-only');
                document.getElementById('dropdownItemRevision').classList.remove('admin-only');
            }

            await cargarRegistrosTrimestral();

            alert(`‚úÖ ¬°Bienvenido ${data.nombre}!\n\nRol: ${data.rol === 'superadmin' ? 'Super Administrador' : 'Enlace'}`);
            
        } else {
            document.getElementById('loadingOverlay').classList.remove('active');
            alert('‚ùå ' + data.error);
        }
        
    } catch (error) {
        console.error('‚ùå Error de login:', error);
        document.getElementById('loadingOverlay').classList.remove('active');
        alert('‚ùå Error de conexi√≥n con el servidor.\n\nPor favor verifica tu conexi√≥n a internet.');
    }
}
    // Login de Usuario (FUNCI√ìN COMPLETA)
   async function registrarUsuario() {
    // Obtener valores y limpiar
    let curp = document.getElementById("reg_curp").value || "";
    let nombre = document.getElementById("reg_nombre").value || "";
    let primer_apellido = document.getElementById("reg_primer_apellido").value || "";
    let segundo_apellido = document.getElementById("reg_segundo_apellido").value || "";
    let correo = document.getElementById("reg_correo").value || "";
    let dependencia = document.getElementById("reg_dependencia").value || "";
    let usuario = document.getElementById("reg_usuario").value || "";
    let password = document.getElementById("reg_password").value || "";

    // Limpiar espacios y convertir a may√∫sculas donde corresponda
    curp = curp.trim().toUpperCase();
    nombre = nombre.trim();
    primer_apellido = primer_apellido.trim();
    segundo_apellido = segundo_apellido.trim();
    correo = correo.trim().toLowerCase();
    dependencia = dependencia.trim();
    usuario = usuario.trim().toUpperCase();
    password = password.trim();

    // Validar campos vac√≠os
    if (!curp) {
        alert("‚ùå El campo CURP es obligatorio");
        document.getElementById("reg_curp").focus();
        return;
    }

    if (!nombre) {
        alert("‚ùå El campo Nombre es obligatorio");
        document.getElementById("reg_nombre").focus();
        return;
    }

    if (!primer_apellido) {
        alert("‚ùå El campo Primer Apellido es obligatorio");
        document.getElementById("reg_primer_apellido").focus();
        return;
    }

    if (!segundo_apellido) {
        alert("‚ùå El campo Segundo Apellido es obligatorio");
        document.getElementById("reg_segundo_apellido").focus();
        return;
    }

    if (!correo) {
        alert("‚ùå El campo Correo es obligatorio");
        document.getElementById("reg_correo").focus();
        return;
    }

    if (!dependencia) {
        alert("‚ùå El campo Dependencia es obligatorio");
        document.getElementById("reg_dependencia").focus();
        return;
    }

    if (!usuario) {
        alert("‚ùå El campo Usuario es obligatorio");
        document.getElementById("reg_usuario").focus();
        return;
    }

    if (!password) {
        alert("‚ùå El campo Contrase√±a es obligatorio");
        document.getElementById("reg_password").focus();
        return;
    }

    // Validar longitud CURP
    if (curp.length !== 18) {
        alert("‚ùå CURP inv√°lido\n\nDebe tener exactamente 18 caracteres.\nActualmente tiene: " + curp.length + " caracteres");
        document.getElementById("reg_curp").focus();
        return;
    }

    // Validar formato CURP
    const curpPattern = /^[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9]{2}$/;
    if (!curpPattern.test(curp)) {
        alert("‚ùå Formato de CURP inv√°lido\n\nFormato correcto:\n‚Ä¢ 4 letras\n‚Ä¢ 6 n√∫meros\n‚Ä¢ H o M\n‚Ä¢ 5 letras\n‚Ä¢ 2 n√∫meros\n\nEjemplo: SALR990312MDFLPC06");
        document.getElementById("reg_curp").focus();
        return;
    }

    // Validar usuario
    if (usuario.length < 3) {
        alert("‚ùå El usuario debe tener al menos 3 caracteres");
        document.getElementById("reg_usuario").focus();
        return;
    }

    // Validar contrase√±a
    if (password.length < 6) {
        alert("‚ùå La contrase√±a debe tener al menos 6 caracteres");
        document.getElementById("reg_password").focus();
        return;
    }

    // Validar email
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailPattern.test(correo)) {
        alert("‚ùå Formato de correo electr√≥nico inv√°lido");
        document.getElementById("reg_correo").focus();
        return;
    }

    try {
        const response = await fetch('/api/auth/register', {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            body: JSON.stringify({ 
                curp: curp,
                nombre: nombre,
                primer_apellido: primer_apellido,
                segundo_apellido: segundo_apellido,
                correo: correo,
                dependencia: dependencia,
                usuario: usuario,
                password: password
            })
        });

        const data = await response.json();

        if (data.success) {
            alert("‚úÖ Usuario registrado correctamente\n\nüë§ Usuario: " + data.usuario + "\n\nüîë Ya puedes iniciar sesi√≥n con tus credenciales.");
            cerrarRegistro();
            document.getElementById("formRegistro").reset();
        } else {
            alert("‚ùå Error al registrar:\n\n" + data.error);
        }
        
    } catch (error) {
        console.error("‚ùå Error:", error);
        alert("‚ùå Error de conexi√≥n con el servidor.\n\nPor favor verifica tu conexi√≥n a internet e intenta nuevamente.");
    }
}

    // Logout
    function logout() {
        if (confirm('¬øEst√° seguro que desea cerrar sesi√≥n?')) {
            document.getElementById('usuario').value = '';
            document.getElementById('password').value = '';
            
            userRole = 'enlace';
            userDependencia = null;
            userName = '';
            
            localStorage.removeItem('SABG_TOKEN');
            localStorage.removeItem('SABG_USUARIO');
            
            document.getElementById('loginScreen').classList.remove('hidden');
            
            document.querySelectorAll('#registrosTable tbody tr').forEach(row => {
                row.style.display = '';
            });
            
            setTimeout(() => {
                alert('üëã Sesi√≥n cerrada exitosamente\n\n¬°Hasta pronto!');
            }, 300);
        }
    }

    // ========================================
    // FUNCIONES DE NAVEGACI√ìN
    // ========================================

    function toggleDropdown(dropdownId, btn) {
        document.querySelectorAll('.dropdown-menu').forEach(menu => {
            if (menu.id !== dropdownId) {
                menu.classList.remove('show');
            }
        });
        
        document.querySelectorAll('.main-nav-btn').forEach(button => {
            if (button !== btn) {
                button.classList.remove('expanded');
            }
        });
        
        const dropdown = document.getElementById(dropdownId);
        dropdown.classList.toggle('show');
        btn.classList.toggle('expanded');
    }

    document.addEventListener('click', function(event) {
        if (!event.target.closest('.nav-item')) {
            document.querySelectorAll('.dropdown-menu').forEach(menu => {
                menu.classList.remove('show');
            });
            document.querySelectorAll('.main-nav-btn').forEach(btn => {
                btn.classList.remove('expanded');
            });
        }
    });

    function showSectionAndTab(sectionId, tabId) {
        document.querySelectorAll('.dropdown-menu').forEach(menu => {
            menu.classList.remove('show');
        });
        document.querySelectorAll('.main-nav-btn').forEach(btn => {
            btn.classList.remove('expanded');
        });
        
        document.querySelectorAll('.main-nav-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        document.querySelectorAll('.main-section').forEach(section => {
            section.classList.remove('active');
        });
        
        document.getElementById(sectionId).classList.add('active');
        
        if (sectionId === 'trimestral') {
            document.querySelectorAll('#trimestral .tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.querySelectorAll('#trimestral .tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
            
            const tabs = document.querySelectorAll('#trimestral .tab');
            tabs.forEach(tab => {
                if ((tabId === 'instructivo' && tab.textContent.includes('Instructivo')) ||
                    (tabId === 'formulario' && tab.textContent.includes('Formulario')) ||
                    (tabId === 'tabla' && tab.textContent.includes('Tabla'))) {
                    tab.classList.add('active');
                }
            });
            
            if (tabId === 'tabla') {
                setTimeout(() => {
                    filtrarTablaPorDependencia();
                }, 100);
            }
        }
        
        if (sectionId === 'evidencias') {
            document.querySelectorAll('#evidencias .subsection').forEach(subsection => {
                subsection.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
        }
    }

    function showMainSection(sectionId) {
        document.querySelectorAll('.dropdown-menu').forEach(menu => {
            menu.classList.remove('show');
        });
        document.querySelectorAll('.main-nav-btn').forEach(btn => {
            btn.classList.remove('expanded');
        });
        
        const sections = document.querySelectorAll('.main-section');
        const navButtons = document.querySelectorAll('.main-nav-btn');

        sections.forEach(section => {
            section.classList.remove('active');
        });

        navButtons.forEach(btn => {
            btn.classList.remove('active');
        });

        document.getElementById(sectionId).classList.add('active');
        
        navButtons.forEach(btn => {
            if (btn.textContent.includes('Inicio') && sectionId === 'inicio') {
                btn.classList.add('active');
            }
        });
    }

    function showTrimestralTab(tabId) {
        const tabs = document.querySelectorAll('#trimestral .tab');
        const tabContents = document.querySelectorAll('#trimestral .tab-content');

        tabs.forEach(tab => {
            tab.classList.remove('active');
        });

        tabContents.forEach(content => {
            content.classList.remove('active');
        });

        tabs.forEach(tab => {
            if ((tabId === 'instructivo' && tab.textContent.includes('Instructivo')) ||
                (tabId === 'formulario' && tab.textContent.includes('Formulario')) ||
                (tabId === 'tabla' && tab.textContent.includes('Tabla'))) {
                tab.classList.add('active');
            }
        });

        document.getElementById(tabId).classList.add('active');
    }

    // ========================================
    // FUNCIONES DE ADMINISTRACI√ìN
    // ========================================
    function togglePanelRevision() {
        const panel = document.getElementById('revision');
        
        if (panel.classList.contains('active')) {
            panel.classList.remove('active');
            document.getElementById('registro').classList.add('active');
            alert('üîí Panel de Revisi√≥n DCEVE ahora oculto');
        } else {
            panel.classList.add('active');
            document.getElementById('registro').classList.remove('active');
            alert('‚úÖ Panel de Revisi√≥n DCEVE ahora visible');
        }
    }

    function desbloquearEdicion() {
        edicionBloqueada = false;
        const estado = document.getElementById('estadoEdicion');
        estado.innerHTML = 'üîì Edici√≥n DESBLOQUEADA';
        estado.style.background = 'linear-gradient(135deg, #10b981, #059669)';
        
        document.querySelectorAll('.editable-cell').forEach(cell => {
            cell.classList.remove('editable-disabled');
        });
        
        alert('‚úÖ Edici√≥n desbloqueada. Los Super Administradores pueden ahora modificar los campos editables.');
    }

    function bloquearEdicion() {
        edicionBloqueada = true;
        const estado = document.getElementById('estadoEdicion');
        estado.innerHTML = 'üîí Edici√≥n BLOQUEADA';
        estado.style.background = 'var(--gradient1)';
        
        document.querySelectorAll('.editable-cell').forEach(cell => {
            cell.classList.add('editable-disabled');
        });
        
        alert('üîí Edici√≥n bloqueada. Los usuarios no pueden modificar los registros.');
    }

    function filtrarTablaPorDependencia() {
        if (userRole === 'superadmin') {
            document.querySelectorAll('#registrosTable tbody tr').forEach(row => {
                row.style.display = '';
            });
            return;
        }
        
        const rows = document.querySelectorAll('#registrosTable tbody tr');
        let visibleCount = 0;
        
        rows.forEach(row => {
            const cells = row.cells;
            if (cells && cells.length > 10) {
                const dependenciaCell = cells[10].textContent.trim();
                
                if (dependenciaCell.toUpperCase().includes(userDependencia.toUpperCase()) ||
                    userDependencia.toUpperCase().includes(dependenciaCell.toUpperCase())) {
                    row.style.display = '';
                    visibleCount++;
                } else {
                    row.style.display = 'none';
                }
            }
        });
        
        if (visibleCount === 0) {
            console.log('No hay registros para la dependencia:', userDependencia);
        }
    }

    function makeEditable(cell) {
        if (userRole !== 'superadmin') {
            alert('‚ö†Ô∏è Solo los Super Administradores pueden editar estos campos.');
            return;
        }
        
        if (edicionBloqueada) {
            alert('üîí La edici√≥n est√° bloqueada. Por favor, desbloquee la edici√≥n primero.');
            return;
        }
        
        if (cell.classList.contains('editing')) {
            return;
        }
        
        const field = cell.dataset.field;
        const currentValue = cell.textContent.trim().replace('‚úèÔ∏è', '').trim();
        
        cell.classList.add('editing');
        
        let editControl;
        
        if (field === 'nivel_educativo') {
            editControl = document.createElement('select');
            editControl.innerHTML = `
                <option value="PRIMARIA">PRIMARIA</option>
                <option value="SECUNDARIA">SECUNDARIA</option>
                <option value="BACHILLERATO">BACHILLERATO</option>
                <option value="LICENCIATURA">LICENCIATURA</option>
                <option value="ESPECIALIDAD">ESPECIALIDAD</option>
                <option value="MAESTR√çA">MAESTR√çA</option>
                <option value="DOCTORADO">DOCTORADO</option>
            `;
            editControl.value = currentValue;
        } else if (field === 'institucion_educativa') {
            editControl = document.createElement('select');
            editControl.innerHTML = `
                <option value="INEA">INEA</option>
                <option value="COLBACH">COLBACH</option>
                <option value="UNADM">UNADM</option>
                <option value="UNRC">UNRC</option>
                <option value="TECNM">TECNM</option>
                <option value="UNIR">UNIR</option>
                <option value="SEP">SEP</option>
            `;
            editControl.value = currentValue;
        } else if (field === 'modalidad') {
            editControl = document.createElement('select');
            editControl.innerHTML = `
                <option value="GU√çA DE ESTUDIO ‚Äì EXAMEN √öNICO (INEA)">GU√çA DE ESTUDIO ‚Äì EXAMEN √öNICO (INEA)</option>
                <option value="APRENDE INEA EN L√çNEA">APRENDE INEA EN L√çNEA</option>
                <option value="PRESENCIAL MEV (INEA)">PRESENCIAL MEV (INEA)</option>
                <option value="NO ESCOLARIZADA/VIRTUAL">NO ESCOLARIZADA/VIRTUAL</option>
                <option value="A DISTANCIA">A DISTANCIA</option>
                <option value="PRESENCIAL">PRESENCIAL</option>
                <option value="ESCOLARIZADA">ESCOLARIZADA</option>
                <option value="MIXTO">MIXTO</option>
            `;
            editControl.value = currentValue;
        } else if (field === 'estado_avance') {
            editControl = document.createElement('select');
            editControl.innerHTML = `
                <option value="CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS">CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS</option>
                <option value="PERSONA INTERESADA">PERSONA INTERESADA</option>
                <option value="PERSONA INSCRITA">PERSONA INSCRITA</option>
                <option value="PERSONA CURSANDO NIVEL EDUCATIVO">PERSONA CURSANDO NIVEL EDUCATIVO</option>
                <option value="PERSONA QUE CONCLUY√ì SUS ESTUDIOS">PERSONA QUE CONCLUY√ì SUS ESTUDIOS</option>
                <option value="PERSONA EN PROCESO DE TITULACI√ìN">PERSONA EN PROCESO DE TITULACI√ìN</option>
                <option value="PERSONA QUE DESERT√ì">PERSONA QUE DESERT√ì</option>
                <option value="PERSONA SUSPENDIDA">PERSONA SUSPENDIDA</option>
                <option value="OTRA">OTRA</option>
            `;
            editControl.value = currentValue;
        } else if (field === 'observaciones') {
            editControl = document.createElement('textarea');
            editControl.value = currentValue;
            editControl.rows = 3;
        }
        
        cell.innerHTML = '';
        cell.appendChild(editControl);
        editControl.focus();
        
        const saveEdit = () => {
            const newValue = editControl.value;
            cell.classList.remove('editing');
            
            if (field === 'institucion_educativa') {
                cell.innerHTML = `${newValue}<span class="edit-icon">‚úèÔ∏è</span>`;
            } else {
                cell.innerHTML = `${newValue}<span class="edit-icon">‚úèÔ∏è</span>`;
            }
            
            if (field === 'estado_avance') {
                const estadosRojos = ['CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS', 'PERSONA QUE DESERT√ì'];
                if (estadosRojos.includes(newValue)) {
                    cell.classList.add('estado-rojo');
                } else {
                    cell.classList.remove('estado-rojo');
                }
            }
            
            alert(`‚úÖ Campo actualizado correctamente!\n\nNuevo valor: ${newValue}`);
        };
        
        editControl.addEventListener('blur', saveEdit);
        editControl.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && field !== 'observaciones') {
                e.preventDefault();
                saveEdit();
            } else if (e.key === 'Escape') {
                cell.classList.remove('editing');
                cell.innerHTML = `${currentValue}<span class="edit-icon">‚úèÔ∏è</span>`;
            }
        });
    }

    // ========================================
    // FUNCIONES DE UTILIDAD
    // ========================================

    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        const particleCount = 50;

        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.width = Math.random() * 5 + 2 + 'px';
            particle.style.height = particle.style.width;
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = Math.random() * 100 + '%';
            particle.style.animationDuration = Math.random() * 20 + 10 + 's';
            particle.style.animationDelay = Math.random() * 5 + 's';
            particlesContainer.appendChild(particle);
        }
    }

    function openMonthModal(month) {
        document.getElementById('monthModal').classList.add('active');
        document.getElementById('modalTitle').textContent = `Registro de Evidencias Mensuales - ${month} 2025`;
    }

    function closeModal() {
        document.getElementById('monthModal').classList.remove('active');
    }

    async function exportData(format) {
    if (userRole !== 'superadmin') {
        alert('‚ö†Ô∏è Solo los Super Administradores pueden exportar datos.');
        return;
    }

    try {
        document.getElementById('loadingOverlay').classList.add('active');
        document.querySelector('.loading-text').textContent = `üì• Exportando a ${format.toUpperCase()}...`;

        let url = '';
        let filename = '';
        let contentType = '';

        if (format === 'excel' || format === 'json') {
            url = '/api/export/excel?format=json';
            filename = `registros_sabg_${new Date().toISOString().split('T')[0]}.json`;
            contentType = 'application/json';
        } else if (format === 'csv') {
            url = '/api/export/excel?format=csv';
            filename = `registros_sabg_${new Date().toISOString().split('T')[0]}.csv`;
            contentType = 'text/csv';
        } else if (format === 'sql') {
            // Para SQL, generamos un dump simple
            alert('‚ö†Ô∏è Exportaci√≥n SQL disponible pr√≥ximamente.\n\nPor ahora usa JSON o CSV y luego importa a tu base de datos.');
            document.getElementById('loadingOverlay').classList.remove('active');
            return;
        }

        const response = await fetch(url);
        
        if (!response.ok) {
            throw new Error('Error al exportar datos');
        }

        const blob = await response.blob();
        const downloadUrl = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = downloadUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(downloadUrl);
        document.body.removeChild(a);

        document.getElementById('loadingOverlay').classList.remove('active');
        document.querySelector('.loading-text').textContent = 'üöÄ Iniciando sesi√≥n...';

        alert(`‚úÖ Datos exportados exitosamente!\n\nFormato: ${format.toUpperCase()}\nArchivo: ${filename}\n\nTotal de registros: ${format === 'csv' ? 'Ver archivo' : 'Ver archivo'}`);

    } catch (error) {
        console.error('Error al exportar:', error);
        document.getElementById('loadingOverlay').classList.remove('active');
        document.querySelector('.loading-text').textContent = 'üöÄ Iniciando sesi√≥n...';
        alert('‚ùå Error al exportar datos: ' + error.message);
    }
}

    // ========================================
    // B√öSQUEDA EN TABLA
    // ========================================
    const searchTableTrimestral = document.getElementById('searchTableTrimestral');
    if (searchTableTrimestral) {
        searchTableTrimestral.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#registrosTable tbody tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });
    }

    // ========================================
    // AUTOCOMPLETADO RAMO-UR Y DEPENDENCIA
    // ========================================
    const ramosUR = ['2-0','4-0','4-A00','4-E2D','4-EZQ','4-F00','4-G00','4-K00','4-N00','4-P00','4-Q00','4-T00','4-X00','5-0','5-I00','5-J00','5-K00','6-0','6-A00','6-B00','6-C00','6-D00','6-E00','6-G0N','6-G1C','6-G1H','6-G2T','6-G3A','6-GSA','6-H00','6-HAT','6-HBW','6-HHN','6-HIU','6-HJO','6-HJY','6-HKA','6-HKI','6-KCZ','7-0','7-H0C','7-H0M','7-HXA','7-HZI','8-0','8-A1I','8-AFU','8-B00','8-C00','8-D00','8-G00','8-I00','8-I6L','8-I9H','8-IZC','8-IZI','8-JAG','8-JBK','8-JBP','8-RJL','8-VSS','8-VST','9-0','9-A00','9-C00','9-D00','9-E00','9-J0U','9-J4Q','9-J9E','9-JZL','9-JZN','9-KDI','10-0','10-K2H','10-K2N','10-K2O','10-K8V','10-LAT','10-LAU','11-0','11-A00','11-B00','11-B01','11-G00','11-K00','11-L00','11-L3P','11-L4J','11-L5N','11-L5X','11-L6H','11-L6I','11-L6J','11-L6W','11-L8G','11-L8K','11-L9T','11-M00','11-MAR','11-MAX','11-MDA','11-MDE','11-MEY','11-MGC','11-MGJ','11-O00','12-0','12-E00','12-I00','12-K00','12-L00','12-M00','12-M7F','12-M7K','12-NAW','12-NBB','12-NBD','12-NBG','12-NBV','12-NCA','12-NCD','12-NCE','12-NCG','12-NCH','12-NCK','12-NCZ','12-NDE','12-NDF','12-NDY','12-NEF','12-NHK','12-O00','12-Q00','12-R00','12-S00','12-T00','12-V00','12-Y00','13-0','13-AYH','13-J2I','13-J2K','13-J2P','13-J2R','13-J2T','13-J2U','13-J2V','13-J2W','13-J2X','13-J2Y','13-J2Z','13-J3A','13-J3B','13-J3C','13-J3D','13-J3E','13-J3F','13-J3G','13-J3L','13-J4V','13-KDN','13-N9W','14-0','14-A00','14-P7R','14-PBE','14-PBJ','14-VUY','15-0','15-B00','15-QCW','15-QDV','15-QEU','15-QEZ','16-0','16-B00','16-E00','16-F00','16-G00','16-RHQ','16-RJE','16-RJJ','18-0','18-A00','18-E00','18-T0K','18-T0O','18-T0Q','18-T0U','18-T4I','18-T4L','18-T4M','18-T4N','18-T4O','18-TOM','18-TON','18-TQA','19-HC6','20-0','20-L00','20-V3A','20-VRW','21-0','21-W3N','21-W3S','25-C00','27-0','27-T00','31-0','32-0','36-0','36-B00','36-C00','36-D00','36-E00','36-F00','36-G00','36-H00','37-0','38-90A','38-90C','38-90E','38-90G','38-90I','38-90K','38-90M','38-90O','38-90Q','38-90S','38-90U','38-90W','38-90X','38-90Y','38-91A','38-91C','38-91E','38-91I','38-91K','38-91M','38-91Q','38-91S','38-91U','38-91W','38-92M','38-9ZU','38-9ZW','38-9ZY','47-AYB','47-AYI','47-AYJ','47-AYL','47-AYM','47-AYN','47-AYO','47-EZN','47-MDL','48-0','48-D00','48-E00','48-F00','48-I00','48-J00','48-L3N','48-L6U','48-L8P','48-L9Y','48-MDB','48-MDC','48-MHL','48-VZG','50-GYR','50-ZZZ','51-GYN','52-T9G','52-T9K','52-T9M','52-T9N','53-TVV','53-UHI','53-UHN','53-UHS','53-UHX','53-UIC','53-UIH','53-UIM','53-UIR','53-UIT','53-UIW','54-0','55-0'];

    const dependencias = ["ADMINISTRACI√ìN DEL PATRIMONIO DE LA BENEFICENCIA P√öBLICA","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO L√ÅZARO C√ÅRDENAS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL ALTAMIRA, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL CABO SAN LUCAS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL COATZACOALCOS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL DOS BOCAS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL ENSENADA, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL GUAYMAS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL MANZANILLO, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL MAZATL√ÅN, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL PROGRESO, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL PUERTO CHIAPAS, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL PUERTO VALLARTA, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL SALINA CRUZ, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL TAMPICO, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL TOPOLOBAMPO, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL TUXPAN, S.A. DE C.V.","ADMINISTRACI√ìN DEL SISTEMA PORTUARIO NACIONAL VERACRUZ, S.A. DE C.V.","AEROPUERTO INTERNACIONAL DE LA CIUDAD DE M√âXICO, S.A. DE C.V.","AEROPUERTO INTERNACIONAL FELIPE √ÅNGELES, S.A. DE C.V.","AEROPUERTOS Y SERVICIOS AUXILIARES","AGENCIA DE TRANSFORMACI√ìN DIGITAL Y TELECOMUNICACIONES","AGENCIA ESPACIAL MEXICANA","AGENCIA FEDERAL DE AVIACI√ìN CIVIL","AGENCIA NACIONAL DE ADUANAS DE M√âXICO","AGENCIA NACIONAL DE SEGURIDAD INDUSTRIAL Y DE PROTECCI√ìN AL MEDIO AMBIENTE DEL SECTOR HIDROCARBUROS","AGROASEMEX, S.A.","ARCHIVO GENERAL DE LA NACI√ìN","AUTORIDAD EDUCATIVA FEDERAL EN LA CIUDAD DE M√âXICO","BANCO DEL BIENESTAR, S.N.C., I.B.D.","BANCO NACIONAL DE COMERCIO EXTERIOR, S.N.C.","BANCO NACIONAL DE OBRAS Y SERVICIOS P√öBLICOS, S.N.C.","BANCO NACIONAL DEL EJ√âRCITO, FUERZA A√âREA Y ARMADA, S.N.C.","CAMINOS Y PUENTES FEDERALES DE INGRESOS Y SERVICIOS CONEXOS","CASA DE MONEDA DE M√âXICO","CENTRO DE CAPACITACI√ìN CINEMATOGR√ÅFICA, A.C.","CENTRO DE ENSE√ëANZA T√âCNICA INDUSTRIAL","CENTRO DE INGENIER√çA Y DESARROLLO INDUSTRIAL","CENTRO DE INVESTIGACI√ìN CIENT√çFICA DE YUCAT√ÅN, A.C.","CENTRO DE INVESTIGACI√ìN CIENT√çFICA Y DE EDUCACI√ìN SUPERIOR DE ENSENADA, BAJA CALIFORNIA","CENTRO DE INVESTIGACI√ìN EN ALIMENTACI√ìN Y DESARROLLO, A.C.","CENTRO DE INVESTIGACI√ìN EN CIENCIAS DE INFORMACI√ìN GEOESPACIAL, A.C.","CENTRO DE INVESTIGACI√ìN EN MATEM√ÅTICAS, A.C.","CENTRO DE INVESTIGACI√ìN EN MATERIALES AVANZADOS, S.C.","CENTRO DE INVESTIGACI√ìN EN QU√çMICA APLICADA","CENTRO DE INVESTIGACI√ìN Y ASISTENCIA EN TECNOLOG√çA Y DISE√ëO DE JALISCO, A.C.","CENTRO DE INVESTIGACI√ìN Y DE ESTUDIOS AVANZADOS DEL IPN","CENTRO DE INVESTIGACI√ìN Y DESARROLLO TECNOL√ìGICO EN ELECTROQU√çMICA, S.C.","CENTRO DE INVESTIGACI√ìN Y DOCENCIA ECON√ìMICAS, A.C.","CENTRO DE INVESTIGACIONES BIOL√ìGICAS DEL NOROESTE, S.C.","CENTRO DE INVESTIGACIONES EN √ìPTICA, A.C.","CENTRO DE INVESTIGACIONES Y ESTUDIOS SUPERIORES EN ANTROPOLOG√çA SOCIAL","CENTRO DE PRODUCCI√ìN DE PROGRAMAS INFORMATIVOS Y ESPECIALES","CENTRO FEDERAL DE CONCILIACI√ìN Y REGISTRO LABORAL","CENTRO NACIONAL DE CONTROL DE ENERG√çA","CENTRO NACIONAL DE CONTROL DEL GAS NATURAL","CENTRO NACIONAL DE EQUIDAD DE G√âNERO Y SALUD REPRODUCTIVA","CENTRO NACIONAL DE EXCELENCIA TECNOL√ìGICA EN SALUD","CENTRO NACIONAL DE LA TRANSFUSI√ìN SANGU√çNEA","CENTRO NACIONAL DE METROLOG√çA","CENTRO NACIONAL DE PREVENCI√ìN DE DESASTRES","CENTRO NACIONAL DE PROGRAMAS PREVENTIVOS Y CONTROL DE ENFERMEDADES","CENTRO NACIONAL DE TRASPLANTES","CENTRO NACIONAL PARA LA PREVENCI√ìN Y CONTROL DEL VIH/SIDA","CENTRO NACIONAL PARA LA SALUD DE LA INFANCIA Y LA ADOLESCENCIA","CENTROS DE INTEGRACI√ìN JUVENIL, A.C.","CIATEC, A.C.","CIATEQ, A.C.","COLEGIO DE BACHILLERES","COLEGIO DE POSTGRADUADOS","COLEGIO NACIONAL DE EDUCACI√ìN PROFESIONAL T√âCNICA","COLEGIO SUPERIOR AGROPECUARIO DEL ESTADO DE GUERRERO","COMISI√ìN DE APELACI√ìN Y ARBITRAJE DEL DEPORTE","COMISI√ìN DE OPERACI√ìN Y FOMENTO DE ACTIVIDADES ACAD√âMICAS DEL IPN","COMISI√ìN EJECUTIVA DE ATENCI√ìN A V√çCTIMAS","COMISI√ìN FEDERAL PARA LA PROTECCI√ìN CONTRA RIESGOS SANITARIOS","COMISI√ìN NACIONAL BANCARIA Y DE VALORES","COMISI√ìN NACIONAL DE ACUACULTURA Y PESCA","COMISI√ìN NACIONAL DE ARBITRAJE M√âDICO","COMISI√ìN NACIONAL DE √ÅREAS NATURALES PROTEGIDAS","COMISI√ìN NACIONAL DE BIO√âTICA","COMISI√ìN NACIONAL DE B√öSQUEDA DE PERSONAS","COMISI√ìN NACIONAL DE CULTURA F√çSICA Y DEPORTE","COMISI√ìN NACIONAL DE HIDROCARBUROS","COMISI√ìN NACIONAL DE LAS ZONAS √ÅRIDAS","COMISI√ìN NACIONAL DE LIBROS DE TEXTO GRATUITOS","COMISI√ìN NACIONAL DE LOS SALARIOS M√çNIMOS","COMISI√ìN NACIONAL DE MEJORA REGULATORIA","COMISI√ìN NACIONAL DE SALUD MENTAL Y ADICCIONES","COMISI√ìN NACIONAL DE SEGURIDAD NUCLEAR Y SALVAGUARDIAS","COMISI√ìN NACIONAL DE SEGUROS Y FIANZAS","COMISI√ìN NACIONAL DE VIVIENDA","COMISI√ìN NACIONAL DEL AGUA","COMISI√ìN NACIONAL DEL SISTEMA DE AHORRO PARA EL RETIRO","COMISI√ìN NACIONAL FORESTAL","COMISI√ìN NACIONAL PARA EL USO EFICIENTE DE LA ENERG√çA","COMISI√ìN NACIONAL PARA LA MEJORA CONTINUA DE LA EDUCACI√ìN","COMISI√ìN NACIONAL PARA LA PROTECCI√ìN Y DEFENSA DE LOS USUARIOS DE SERVICIOS FINANCIEROS","COMISI√ìN REGULADORA DE ENERG√çA","COMIT√â NACIONAL PARA EL DESARROLLO SUSTENTABLE DE LA CA√ëA DE AZ√öCAR","COMPA√ë√çA MEXICANA DE EXPLORACIONES, S.A. DE C.V.","COMPA√ë√çA OPERADORA DEL CENTRO CULTURAL Y TUR√çSTICO DE TIJUANA, S.A. DE C.V.","CONSEJER√çA JUR√çDICA DEL EJECUTIVO FEDERAL","CONSEJO NACIONAL DE EVALUACI√ìN DE LA POL√çTICA DE DESARROLLO SOCIAL","CONSEJO NACIONAL DE FOMENTO EDUCATIVO","CONSEJO NACIONAL DE HUMANIDADES, CIENCIAS Y TECNOLOG√çAS","CONSEJO NACIONAL PARA EL DESARROLLO Y LA INCLUSI√ìN DE LAS PERSONAS CON DISCAPACIDAD","CONSEJO NACIONAL PARA PREVENIR LA DISCRIMINACI√ìN","CONSOLIDADO","COORDINACI√ìN GENERAL DE LA COMISI√ìN MEXICANA DE AYUDA A REFUGIADOS","COORDINACI√ìN NACIONAL ANTISECUESTRO Y DELITOS DE ALTO IMPACTO","COORDINACI√ìN NACIONAL DE BECAS PARA EL BIENESTAR BENITO JU√ÅREZ","COORDINACI√ìN PARA LA ATENCI√ìN INTEGRAL DE LA MIGRACI√ìN EN LA FRONTERA SUR","CORREDOR INTEROCE√ÅNICO DEL ISTMO DE TEHUANTEPEC","EDUCAL, S.A. DE C.V.","EL COLEGIO DE LA FRONTERA NORTE, A.C.","EL COLEGIO DE LA FRONTERA SUR","EL COLEGIO DE M√âXICO, A.C.","EL COLEGIO DE MICHOAC√ÅN, A.C.","EL COLEGIO DE SAN LUIS, A.C.","ESTUDIOS CHURUBUSCO AZTECA, S.A.","EXPORTADORA DE SAL, S.A. DE C.V.","FERROCARRIL DEL ISTMO DE TEHUANTEPEC, S.A. DE C.V.","FIDEICOMISO DE FOMENTO MINERO","FIDEICOMISO DE LOS SISTEMAS NORMALIZADO DE COMPETENCIA LABORAL Y DE CERTIFICACI√ìN","FIDEICOMISO DE RIESGO COMPARTIDO","FIDEICOMISO FONDO NACIONAL DE FOMENTO EJIDAL","FIDEICOMISO PARA LA CINETECA NACIONAL","FIDEICOMISO UNIVERSIDAD MAR√çTIMA Y PORTUARIA DE M√âXICO","FINANCIERA PARA EL BIENESTAR","FONATUR INFRAESTRUCTURA, S.A. DE C.V.","FONDO DE CAPITALIZACI√ìN E INVERSI√ìN DEL SECTOR RURAL","FONDO DE CULTURA ECON√ìMICA","FONDO DE GARANT√çA Y FOMENTO PARA LA AGRICULTURA, GANADER√çA Y AVICULTURA","FONDO DE LA VIVIENDA DEL ISSSTE","FONDO NACIONAL DE FOMENTO AL TURISMO","FONDO NACIONAL PARA EL FOMENTO DE LAS ARTESAN√çAS","GUARDIA NACIONAL","HOSPITAL GENERAL DR. MANUEL GEA GONZ√ÅLEZ","HOSPITAL GENERAL DE M√âXICO DR. EDUARDO LICEAGA","HOSPITAL INFANTIL DE M√âXICO FEDERICO G√ìMEZ","HOSPITAL JU√ÅREZ DE M√âXICO","IMPRESORA Y ENCUADERNADORA PROGRESO, S.A. DE C.V.","INFOTEC CENTRO DE INVESTIGACI√ìN E INNOVACI√ìN EN TIC","INNOVABIENESTAR DE M√âXICO, S.A.P.I. DE C.V.","INSTITUTO DE ADMINISTRACI√ìN Y AVAL√öOS DE BIENES NACIONALES","INSTITUTO DE ECOLOG√çA, A.C.","INSTITUTO DE INVESTIGACIONES DR. JOS√â MAR√çA LUIS MORA","INSTITUTO DE SEGURIDAD SOCIAL PARA LAS FUERZAS ARMADAS MEXICANAS","INSTITUTO DE SEGURIDAD Y SERVICIOS SOCIALES DE LOS TRABAJADORES DEL ESTADO","INSTITUTO DEL FONDO NACIONAL PARA EL CONSUMO DE LOS TRABAJADORES","INSTITUTO MEXICANO DE CINEMATOGRAF√çA","INSTITUTO MEXICANO DE INVESTIGACI√ìN EN PESCA Y ACUACULTURA SUSTENTABLES","INSTITUTO MEXICANO DE LA PROPIEDAD INDUSTRIAL","INSTITUTO MEXICANO DE LA RADIO","INSTITUTO MEXICANO DE TECNOLOG√çA DEL AGUA","INSTITUTO MEXICANO DEL PETR√ìLEO","INSTITUTO MEXICANO DEL SEGURO SOCIAL","INSTITUTO MEXICANO DEL TRANSPORTE","INSTITUTO NACIONAL DE ANTROPOLOG√çA E HISTORIA","INSTITUTO NACIONAL DE ASTROF√çSICA, √ìPTICA Y ELECTR√ìNICA","INSTITUTO NACIONAL DE BELLAS ARTES Y LITERATURA","INSTITUTO NACIONAL DE CANCEROLOG√çA","INSTITUTO NACIONAL DE CARDIOLOG√çA IGNACIO CH√ÅVEZ","INSTITUTO NACIONAL DE CIENCIAS M√âDICAS Y NUTRICI√ìN SALVADOR ZUBIR√ÅN","INSTITUTO NACIONAL DE ECOLOG√çA Y CAMBIO CLIM√ÅTICO","INSTITUTO NACIONAL DE ELECTRICIDAD Y ENERG√çAS LIMPIAS","INSTITUTO NACIONAL DE ENFERMEDADES RESPIRATORIAS ISMAEL COS√çO VILLEGAS","INSTITUTO NACIONAL DE GERIATR√çA","INSTITUTO NACIONAL DE INVESTIGACIONES FORESTALES, AGR√çCOLAS Y PECUARIAS","INSTITUTO NACIONAL DE INVESTIGACIONES NUCLEARES","INSTITUTO NACIONAL DE LA ECONOM√çA SOCIAL","INSTITUTO NACIONAL DE LA INFRAESTRUCTURA F√çSICA EDUCATIVA","INSTITUTO NACIONAL DE LAS MUJERES","INSTITUTO NACIONAL DE LAS PERSONAS ADULTAS MAYORES","INSTITUTO NACIONAL DE LENGUAS IND√çGENAS","INSTITUTO NACIONAL DE LOS PUEBLOS IND√çGENAS","INSTITUTO NACIONAL DE MEDICINA GEN√ìMICA","INSTITUTO NACIONAL DE MIGRACI√ìN","INSTITUTO NACIONAL DE NEUROLOG√çA Y NEUROCIRUG√çA MANUEL VELASCO SU√ÅREZ","INSTITUTO NACIONAL DE PEDIATR√çA","INSTITUTO NACIONAL DE PERINATOLOG√çA ISIDRO ESPINOSA DE LOS REYES","INSTITUTO NACIONAL DE PSIQUIATR√çA RAM√ìN DE LA FUENTE MU√ëIZ","INSTITUTO NACIONAL DE REHABILITACI√ìN LUIS GUILLERMO IBARRA IBARRA","INSTITUTO NACIONAL DE SALUD P√öBLICA","INSTITUTO NACIONAL DEL SUELO SUSTENTABLE","INSTITUTO NACIONAL PARA EL DESARROLLO DE CAPACIDADES DEL SECTOR RURAL, A.C.","INSTITUTO NACIONAL PARA EL FEDERALISMO Y EL DESARROLLO MUNICIPAL","INSTITUTO NACIONAL PARA LA EDUCACI√ìN DE LOS ADULTOS","INSTITUTO PARA DEVOLVER AL PUEBLO LO ROBADO","INSTITUTO PARA LA PROTECCI√ìN AL AHORRO BANCARIO","INSTITUTO POLIT√âCNICO NACIONAL","INSTITUTO POTOSINO DE INVESTIGACI√ìN CIENT√çFICA Y TECNOL√ìGICA, A.C.","LABORATORIOS DE BIOL√ìGICOS Y REACTIVOS DE M√âXICO, S.A. DE C.V.","LITIO PARA M√âXICO","LOTER√çA NACIONAL","NACIONAL FINANCIERA, S.N.C.","OFICINA DE LA PRESIDENCIA DE LA REP√öBLICA","ORGANISMO COORDINADOR DE UNIVERSIDADES PARA EL BIENESTAR BENITO JU√ÅREZ","ORGANISMO PROMOTOR DE INVERSIONES EN TELECOMUNICACIONES","PATRONATO DE OBRAS E INSTALACIONES DEL IPN","PEMEX CORPORATIVO","PREVENCI√ìN Y REINSERCI√ìN SOCIAL","PROCURADUR√çA AGRARIA","PROCURADUR√çA DE LA DEFENSA DEL CONTRIBUYENTE","PROCURADUR√çA FEDERAL DE LA DEFENSA DEL TRABAJO","PROCURADUR√çA FEDERAL DE PROTECCI√ìN AL AMBIENTE","PROCURADUR√çA FEDERAL DEL CONSUMIDOR","PRODUCTORA NACIONAL DE BIOL√ìGICOS VETERINARIOS","RADIO EDUCACI√ìN","REGISTRO AGRARIO NACIONAL","SECRETAR√çA ANTICORRUPCI√ìN Y BUEN GOBIERNO","SECRETAR√çA DE AGRICULTURA Y DESARROLLO RURAL","SECRETAR√çA DE BIENESTAR","SECRETAR√çA DE CULTURA","SECRETAR√çA DE DESARROLLO AGRARIO, TERRITORIAL Y URBANO","SECRETAR√çA DE ECONOM√çA","SECRETAR√çA DE EDUCACI√ìN P√öBLICA","SECRETAR√çA DE ENERG√çA","SECRETAR√çA DE GOBERNACI√ìN","SECRETAR√çA DE HACIENDA Y CR√âDITO P√öBLICO","SECRETAR√çA DE INFRAESTRUCTURA, COMUNICACIONES Y TRANSPORTES","SECRETAR√çA DE LA DEFENSA NACIONAL","SECRETAR√çA DE MEDIO AMBIENTE Y RECURSOS NATURALES","SECRETAR√çA DE RELACIONES EXTERIORES","SECRETAR√çA DE SALUD","SECRETAR√çA DE SEGURIDAD Y PROTECCI√ìN CIUDADANA","SECRETAR√çA DE TURISMO","SECRETAR√çA DEL TRABAJO Y PREVISI√ìN SOCIAL","SECRETAR√çA EJECUTIVA DEL SISTEMA NACIONAL ANTICORRUPCI√ìN","SECRETAR√çA GENERAL DEL CONSEJO NACIONAL DE POBLACI√ìN","SECRETARIADO EJECUTIVO DEL SISTEMA NACIONAL DE SEGURIDAD P√öBLICA","SEGURIDAD ALIMENTARIA MEXICANA","SERVICIO DE ADMINISTRACI√ìN TRIBUTARIA","SERVICIO DE INFORMACI√ìN AGROALIMENTARIA Y PESQUERA","SERVICIO DE PROTECCI√ìN FEDERAL","SERVICIO GEOL√ìGICO MEXICANO","SERVICIO NACIONAL DE INSPECCI√ìN Y CERTIFICACI√ìN DE SEMILLAS","SERVICIO NACIONAL DE SANIDAD, INOCUIDAD Y CALIDAD AGROALIMENTARIA","SERVICIO POSTAL MEXICANO","SERVICIOS A LA NAVEGACI√ìN EN EL ESPACIO A√âREO MEXICANO","SERVICIOS DE SALUD DEL IMSS-BIENESTAR","SISTEMA NACIONAL PARA EL DESARROLLO INTEGRAL DE LA FAMILIA","SISTEMA P√öBLICO DE RADIODIFUSI√ìN DEL ESTADO MEXICANO","SOCIEDAD HIPOTECARIA FEDERAL, S.N.C.","TALLERES GR√ÅFICOS DE M√âXICO","TECNOL√ìGICO NACIONAL DE M√âXICO","TELEVISI√ìN METROPOLITANA, S.A. DE C.V.","TREN MAYA, S.A. DE C.V.","TRIBUNAL FEDERAL DE CONCILIACI√ìN Y ARBITRAJE","TRIBUNAL FEDERAL DE JUSTICIA FISCAL Y ADMINISTRATIVA","TRIBUNAL SUPERIOR AGRARIO","TUR√çSTICA INTEGRAL ISLAS MAR√çAS, S.A. DE C.V.","UNIDAD DEL SISTEMA PARA LA CARRERA DE LAS MAESTRAS Y LOS MAESTROS","UNIVERSIDAD ABIERTA Y A DISTANCIA DE M√âXICO","UNIVERSIDAD AUT√ìNOMA CHAPINGO","UNIVERSIDAD PEDAG√ìGICA NACIONAL","XE-IPN CANAL 11"];

    function initAutocomplete() {
        const ramoInput = document.getElementById('ramoUrInput');
        const ramoSuggestions = document.getElementById('ramoUrSuggestions');
        const depInput = document.getElementById('dependenciaInput');
        const depSuggestions = document.getElementById('dependenciaSuggestions');

        if (ramoInput && ramoSuggestions) {
            setupAutocomplete(ramoInput, ramoSuggestions, ramosUR);
        }

        if (depInput && depSuggestions) {
            setupAutocomplete(depInput, depSuggestions, dependencias);
        }
    }

    function setupAutocomplete(input, suggestionsContainer, dataList) {
        let currentFocus = -1;

        input.addEventListener('input', function() {
            const value = this.value.toLowerCase();
            currentFocus = -1;
            suggestionsContainer.innerHTML = '';

            if (!value) {
                suggestionsContainer.classList.remove('show');
                return;
            }

            const filtered = dataList.filter(item => 
                item.toLowerCase().includes(value)
            );

            if (filtered.length === 0) {
                suggestionsContainer.innerHTML = '<div class="no-suggestions">No se encontraron coincidencias</div>';
                suggestionsContainer.classList.add('show');
                return;
            }

            filtered.forEach(item => {
                const div = document.createElement('div');
                div.className = 'suggestion-item';
                
                const pos = item.toLowerCase().indexOf(value);
                const beforeMatch = item.substring(0, pos);
                const matchText = item.substring(pos, pos + value.length);
                const afterMatch = item.substring(pos + value.length);
                
                div.innerHTML = beforeMatch + '<span class="suggestion-highlight">' + matchText + '</span>' + afterMatch;
                
                div.addEventListener('click', function() {
                    input.value = item;
                    suggestionsContainer.classList.remove('show');
                });
                
                suggestionsContainer.appendChild(div);
            });

            suggestionsContainer.classList.add('show');
        });

        document.addEventListener('click', function(e) {
            if (e.target !== input && e.target !== suggestionsContainer) {
                suggestionsContainer.classList.remove('show');
            }
        });
    }

    // ========================================
    // INICIALIZACI√ìN
    // ========================================
    window.addEventListener('load', () => {
        createParticles();
        initAutocomplete();
    });

    // Cerrar modal al hacer clic fuera
    window.addEventListener('click', (e) => {
        const modal = document.getElementById('monthModal');
        if (e.target === modal) {
            closeModal();
        }
    });

    console.log('‚úÖ Sistema de Promoci√≥n de la Formaci√≥n Acad√©mica cargado exitosamente!');

    async function cargarRegistrosTrimestral() {
    try {
        const url = userRole === 'superadmin' 
            ? '/api/trimestral/list'
            : `/api/trimestral/list?dependencia=${encodeURIComponent(userDependencia)}`;

        const response = await fetch(url);
        const result = await response.json();

        if (result.success) {
            const tbody = document.querySelector('#registrosTable tbody');
            tbody.innerHTML = '';

            result.data.forEach((registro, index) => {
                const row = tbody.insertRow();
                
                // Determinar si el estado de avance est√° desactualizado
                const estadosRojos = ['CAMBI√ì LA INSTITUCI√ìN ACAD√âMICA DE INTER√âS', 'PERSONA QUE DESERT√ì'];
                const claseEstadoRojo = estadosRojos.includes(registro.estado_avance) ? 'estado-rojo' : '';
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${registro.trimestre || ''}</td>
                    <td>${registro.id_rusp || ''}</td>
                    <td>${registro.primer_apellido || ''}</td>
                    <td>${registro.segundo_apellido || ''}</td>
                    <td>${registro.nombre || ''}</td>
                    <td>${registro.curp || ''}</td>
                    <td>${registro.nivel_puesto || ''}</td>
                    <td>${registro.nivel_tabular || ''}</td>
                    <td>${registro.ramo_ur || ''}</td>
                    <td>${registro.dependencia || ''}</td>
                    <td>${registro.correo_institucional || ''}</td>
                    <td>${registro.telefono_institucional || ''}</td>
                    <td class="editable-cell" data-field="nivel_educativo" onclick="makeEditable(this)" role="button" tabindex="0">
                        ${registro.nivel_educativo || ''}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </td>
                    <td class="editable-cell" data-field="institucion_educativa" onclick="makeEditable(this)" role="button" tabindex="0">
                        ${registro.institucion_educativa || ''}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </td>
                    <td class="editable-cell" data-field="modalidad" onclick="makeEditable(this)" role="button" tabindex="0">
                        ${registro.modalidad || ''}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </td>
                    <td class="editable-cell ${claseEstadoRojo}" data-field="estado_avance" onclick="makeEditable(this)" role="button" tabindex="0">
                        ${registro.estado_avance || ''}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </td>
                    <td class="editable-cell" data-field="observaciones" onclick="makeEditable(this)" role="button" tabindex="0">
                        ${registro.observaciones || '-'}
                        <span class="edit-icon">‚úèÔ∏è</span>
                    </td>
                    <td>${registro.enlace_nombre || ''}</td>
                    <td>${registro.enlace_primer_apellido || ''}</td>
                    <td>${registro.enlace_segundo_apellido || ''}</td>
                    <td>${registro.enlace_correo || ''}</td>
                    <td>${registro.enlace_telefono || ''}</td>
                `;
            });
        }
    } catch (error) {
        console.error('Error al cargar registros:', error);
    }
}
async function guardarRegistroTrimestral() {
    const form = document.getElementById('trimestralForm');
    const formData = new FormData(form);
    
    const data = {
        enlace_nombre: formData.get('enlace_nombre'),
        enlace_primer_apellido: formData.get('enlace_apellido1'),
        enlace_segundo_apellido: formData.get('enlace_apellido2'),
        enlace_correo: formData.get('enlace_correo'),
        enlace_telefono: formData.get('enlace_telefono'),
        trimestre: formData.get('trimestre'),
        id_rusp: formData.get('id_rusp'),
        primer_apellido: formData.get('primer_apellido'),
        segundo_apellido: formData.get('segundo_apellido'),
        nombre: formData.get('nombre'),
        curp: formData.get('curp'),
        nivel_puesto: formData.get('nivel_puesto'),
        nivel_tabular: formData.get('nivel_tabular'),
        ramo_ur: formData.get('ramo_ur'),
        dependencia: formData.get('dependencia'),
        correo_institucional: formData.get('correo_institucional'),
        telefono_institucional: formData.get('telefono_institucional'),
        nivel_educativo: formData.get('nivel_educativo'),
        institucion_educativa: formData.get('institucion_educativa'),
        modalidad: formData.get('modalidad'),
        estado_avance: formData.get('estado_avance'),
        observaciones: formData.get('observaciones'),
        usuario_registro: userName
    };

    try {
        const response = await fetch('/api/trimestral/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });

        const result = await response.json();

        if (result.success) {
            alert('‚úÖ Registro guardado exitosamente!');
            form.reset();
            await cargarRegistrosTrimestral();
        } else {
            alert('‚ùå Error: ' + result.error);
        }
    } catch (error) {
        console.error('Error al guardar:', error);
        alert('‚ùå Error de conexi√≥n con el servidor');
    }
}
            // ========================================
// BACKUP DE BASE DE DATOS
// ========================================
async function descargarBackup() {
    if (userRole !== 'superadmin') {
        alert('‚ö†Ô∏è Solo los Super Administradores pueden descargar backups.');
        return;
    }

    if (!confirm('¬øDeseas descargar el backup completo de la base de datos?\n\nEsto incluye:\n‚Ä¢ Todos los registros trimestrales\n‚Ä¢ Informaci√≥n de usuarios (sin contrase√±as)\n‚Ä¢ Fecha y hora del backup')) {
        return;
    }

    try {
        document.getElementById('loadingOverlay').classList.add('active');
        document.querySelector('.loading-text').textContent = 'üíæ Generando backup...';

        const response = await fetch('/api/backup/export');
        
        if (!response.ok) {
            throw new Error('Error al generar backup');
        }

        const blob = await response.blob();
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `backup_sabg_${new Date().toISOString().split('T')[0]}.json`;
        document.body.appendChild(a);
        a.click();
        window.URL.revokeObjectURL(url);
        document.body.removeChild(a);

        document.getElementById('loadingOverlay').classList.remove('active');
        document.querySelector('.loading-text').textContent = 'üöÄ Iniciando sesi√≥n...';

        alert('‚úÖ Backup descargado exitosamente!\n\nArchivo: backup_sabg_' + new Date().toISOString().split('T')[0] + '.json\n\nGuarda este archivo en un lugar seguro.');

    } catch (error) {
        console.error('Error al descargar backup:', error);
        document.getElementById('loadingOverlay').classList.remove('active');
        alert('‚ùå Error al generar backup: ' + error.message);
    }
}
    </script>
</body>
</html>
